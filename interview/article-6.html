<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>VUE2 VUE3面试题 | 前端食堂</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/assets/logo.png">
    <meta name="description" content="A lightweight creator for VuePress project.">
    <link rel="preload" href="/assets/css/0.styles.a0bdfdfc.css" as="style"><link rel="preload" href="/assets/js/app.297cbe38.js" as="script"><link rel="preload" href="/assets/js/3.74b310ed.js" as="script"><link rel="preload" href="/assets/js/8.54bfb320.js" as="script"><link rel="prefetch" href="/assets/js/10.2cb4252a.js"><link rel="prefetch" href="/assets/js/11.84195d0b.js"><link rel="prefetch" href="/assets/js/12.99922e8c.js"><link rel="prefetch" href="/assets/js/13.e933f068.js"><link rel="prefetch" href="/assets/js/14.ac37b5f6.js"><link rel="prefetch" href="/assets/js/15.0ca846a4.js"><link rel="prefetch" href="/assets/js/16.5bb89187.js"><link rel="prefetch" href="/assets/js/17.ee12d807.js"><link rel="prefetch" href="/assets/js/18.ab1887b7.js"><link rel="prefetch" href="/assets/js/19.5cc22fdc.js"><link rel="prefetch" href="/assets/js/20.329addb7.js"><link rel="prefetch" href="/assets/js/21.c39c3d03.js"><link rel="prefetch" href="/assets/js/22.4b2a4625.js"><link rel="prefetch" href="/assets/js/23.c579329b.js"><link rel="prefetch" href="/assets/js/24.27361bff.js"><link rel="prefetch" href="/assets/js/25.ceb28791.js"><link rel="prefetch" href="/assets/js/26.b03616fe.js"><link rel="prefetch" href="/assets/js/27.f9440421.js"><link rel="prefetch" href="/assets/js/28.54b87ba6.js"><link rel="prefetch" href="/assets/js/29.8ec65517.js"><link rel="prefetch" href="/assets/js/30.1bf88e2a.js"><link rel="prefetch" href="/assets/js/31.6c4d3d02.js"><link rel="prefetch" href="/assets/js/32.fb7071fa.js"><link rel="prefetch" href="/assets/js/33.d6f2a94a.js"><link rel="prefetch" href="/assets/js/34.5e399a3e.js"><link rel="prefetch" href="/assets/js/35.3acd0425.js"><link rel="prefetch" href="/assets/js/36.78ec183b.js"><link rel="prefetch" href="/assets/js/37.f9728d1d.js"><link rel="prefetch" href="/assets/js/38.1bf134e8.js"><link rel="prefetch" href="/assets/js/39.f6ab4637.js"><link rel="prefetch" href="/assets/js/4.d0cd8535.js"><link rel="prefetch" href="/assets/js/40.2ef36b4f.js"><link rel="prefetch" href="/assets/js/41.93f45d18.js"><link rel="prefetch" href="/assets/js/42.aec6da59.js"><link rel="prefetch" href="/assets/js/43.d62e0931.js"><link rel="prefetch" href="/assets/js/44.2820c42d.js"><link rel="prefetch" href="/assets/js/45.0e459d5b.js"><link rel="prefetch" href="/assets/js/46.de66f200.js"><link rel="prefetch" href="/assets/js/47.37e6bfeb.js"><link rel="prefetch" href="/assets/js/48.c49e08c2.js"><link rel="prefetch" href="/assets/js/49.7c5b3d1f.js"><link rel="prefetch" href="/assets/js/5.2a66155c.js"><link rel="prefetch" href="/assets/js/50.08a70dfd.js"><link rel="prefetch" href="/assets/js/51.c50c547d.js"><link rel="prefetch" href="/assets/js/52.0353a465.js"><link rel="prefetch" href="/assets/js/53.5866843b.js"><link rel="prefetch" href="/assets/js/54.4c76ec09.js"><link rel="prefetch" href="/assets/js/55.e2d45d00.js"><link rel="prefetch" href="/assets/js/56.40d578c9.js"><link rel="prefetch" href="/assets/js/57.90aa6436.js"><link rel="prefetch" href="/assets/js/58.0fb4da38.js"><link rel="prefetch" href="/assets/js/59.5a2a439f.js"><link rel="prefetch" href="/assets/js/6.feef556c.js"><link rel="prefetch" href="/assets/js/60.ff15aaaf.js"><link rel="prefetch" href="/assets/js/61.f20de356.js"><link rel="prefetch" href="/assets/js/62.13531d49.js"><link rel="prefetch" href="/assets/js/63.1e39920f.js"><link rel="prefetch" href="/assets/js/64.6ffb28d1.js"><link rel="prefetch" href="/assets/js/65.0a4871be.js"><link rel="prefetch" href="/assets/js/66.eb592ae7.js"><link rel="prefetch" href="/assets/js/67.7e81dfca.js"><link rel="prefetch" href="/assets/js/68.65945d55.js"><link rel="prefetch" href="/assets/js/69.bea1e7e1.js"><link rel="prefetch" href="/assets/js/7.e54d7447.js"><link rel="prefetch" href="/assets/js/70.2b6f8144.js"><link rel="prefetch" href="/assets/js/71.1e8b1f04.js"><link rel="prefetch" href="/assets/js/72.360b7cde.js"><link rel="prefetch" href="/assets/js/73.1b3645fb.js"><link rel="prefetch" href="/assets/js/74.8180063d.js"><link rel="prefetch" href="/assets/js/9.996f8f86.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.10206f39.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a0bdfdfc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">前端食堂</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><a class="ant-dropdown-link ant-dropdown-trigger">
      Hover me <i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></a> <a href="https://github.com/wjhuan/frontend-learn-route" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/interview/" aria-current="page" title="README.md" class="sidebar-link">README.md</a></li><li><a href="/interview/article-1.html" title="CSS面试题" class="sidebar-link">CSS面试题</a></li><li><a href="/interview/article-2.html" title="DOM和BOM面试题" class="sidebar-link">DOM和BOM面试题</a></li><li><a href="/interview/article-3.html" title="webpack和babel面试题" class="sidebar-link">webpack和babel面试题</a></li><li><a href="/interview/article-4.html" title="js面试题" class="sidebar-link">js面试题</a></li><li><a href="/interview/article-5.html" title="网络面试题" class="sidebar-link">网络面试题</a></li><li><a href="/interview/article-6.html" aria-current="page" title="VUE2 VUE3面试题" class="active sidebar-link">VUE2 VUE3面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-computed-和-watch-区别" title="Vue computed 和 watch 区别" class="sidebar-link">Vue computed 和 watch 区别</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-组件通讯" title="Vue 组件通讯" class="sidebar-link">Vue 组件通讯</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vuex-mutation-action-区别" title="Vuex mutation action 区别" class="sidebar-link">Vuex mutation action 区别</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-生命周期" title="Vue 生命周期" class="sidebar-link">Vue 生命周期</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-router-模式" title="Vue-router 模式" class="sidebar-link">Vue-router 模式</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#你在实际工作中-做过哪些-vue-优化" title="你在实际工作中，做过哪些 Vue 优化？" class="sidebar-link">你在实际工作中，做过哪些 Vue 优化？</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#连环问-vue-遇到过哪些坑" title="连环问：Vue 遇到过哪些坑？？？" class="sidebar-link">连环问：Vue 遇到过哪些坑？？？</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-错误监听" title="Vue 错误监听" class="sidebar-link">Vue 错误监听</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#谈一下你对-mvvm-原理的理解" title="谈一下你对 mvvm 原理的理解" class="sidebar-link">谈一下你对 mvvm 原理的理解</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#请说一下-vue2-响应式数据的原理" title="请说一下 vue2 响应式数据的原理？" class="sidebar-link">请说一下 vue2 响应式数据的原理？</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue2-中是如何检测数组变化" title="vue2 中是如何检测数组变化?" class="sidebar-link">vue2 中是如何检测数组变化?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#为什么-vue2-采用异步渲染" title="为什么 vue2 采用异步渲染?" class="sidebar-link">为什么 vue2 采用异步渲染?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#nexttick-实现原理" title="nextTick 实现原理?" class="sidebar-link">nextTick 实现原理?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue2-中的-computed-的特点" title="vue2 中的 Computed 的特点？" class="sidebar-link">vue2 中的 Computed 的特点？</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#何时需要使用-beforedestroy" title="何时需要使用 beforeDestroy" class="sidebar-link">何时需要使用 beforeDestroy</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-中模板编译原理" title="vue 中模板编译原理" class="sidebar-link">vue 中模板编译原理</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-中-v-if-和-v-show-的区别" title="Vue 中 v-if 和 V-show 的区别?" class="sidebar-link">Vue 中 v-if 和 V-show 的区别?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#为什么-v-for-和-v-if-不能连用" title="为什么 V-for 和 v-if 不能连用" class="sidebar-link">为什么 V-for 和 v-if 不能连用</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#用-vnode-来描述一个-dom-结构" title="用 vnode 来描述一个 DOM 结构?" class="sidebar-link">用 vnode 来描述一个 DOM 结构?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue2-diff-算法的时间复杂度" title="vue2 diff 算法的时间复杂度" class="sidebar-link">vue2 diff 算法的时间复杂度</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#简述-vue2-中-diff-算法原理" title="简述 Vue2 中 diff 算法原理" class="sidebar-link">简述 Vue2 中 diff 算法原理</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#v-for-中为什么要用-key" title="V-for 中为什么要用 key?" class="sidebar-link">V-for 中为什么要用 key?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#描述-vue2-组件渲染和更新过程" title="描述 vue2 组件渲染和更新过程" class="sidebar-link">描述 vue2 组件渲染和更新过程</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue2-组件中的-data-为什么是一个函数" title="vue2 组件中的 data 为什么是一个函数?" class="sidebar-link">vue2 组件中的 data 为什么是一个函数?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue2-中事件绑定的原理" title="vue2 中事件绑定的原理" class="sidebar-link">vue2 中事件绑定的原理</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#v-model-的实现原理及如何自定义" title="v-model 的实现原理及如何自定义" class="sidebar-link">v-model 的实现原理及如何自定义</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#sync-修饰符的原理" title=".sync 修饰符的原理" class="sidebar-link">.sync 修饰符的原理</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#sync-与-v-model-区别" title=".sync 与 v-model 区别" class="sidebar-link">.sync 与 v-model 区别</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-中-v-html-会导致哪些问题" title="Vue 中 v-html 会导致哪些问题?" class="sidebar-link">Vue 中 v-html 会导致哪些问题?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-父子组件生命周期调用顺序" title="vue 父子组件生命周期调用顺序" class="sidebar-link">vue 父子组件生命周期调用顺序</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#为什么要使用异步组件" title="为什么要使用异步组件 ?" class="sidebar-link">为什么要使用异步组件 ?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#什么是插槽" title="什么是插槽?" class="sidebar-link">什么是插槽?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#谈谈你对-keep-alive-的了解" title="谈谈你对 keep-alive 的了解？" class="sidebar-link">谈谈你对 keep-alive 的了解？</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-中常见性能优化" title="Vue 中常见性能优化" class="sidebar-link">Vue 中常见性能优化</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#hash-路由和-history-路由区别" title="hash 路由和 history 路由区别" class="sidebar-link">hash 路由和 history 路由区别</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#vue-router-中导航守卫有哪些" title="Vue-Router 中导航守卫有哪些 ?" class="sidebar-link">Vue-Router 中导航守卫有哪些 ?</a></li><li class="sidebar-sub-header"><a href="/interview/article-6.html#说一下-vite-的原理" title="说一下 vite 的原理" class="sidebar-link">说一下 vite 的原理</a></li></ul></li><li><a href="/interview/article-7.html" title="nodejs 面试题" class="sidebar-link">nodejs 面试题</a></li><li><a href="/interview/article-8.html" title="实战经验" class="sidebar-link">实战经验</a></li><li><a href="/interview/article-9.html" title="typescript面试题" class="sidebar-link">typescript面试题</a></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="vue2-vue3-面试题"><a href="#vue2-vue3-面试题" class="header-anchor">#</a> VUE2 VUE3 面试题</h1> <h2 id="vue-computed-和-watch-区别"><a href="#vue-computed-和-watch-区别" class="header-anchor">#</a> Vue computed 和 watch 区别</h2> <h3 id="两者设计用途不同"><a href="#两者设计用途不同" class="header-anchor">#</a> 两者设计用途不同</h3> <ul><li>computed 用于产出二次处理之后的数据，如对于一个列表进行 filter 处理</li> <li>watch 用于监听数据变化（如 v-model 时，数据可能被动改变，需要监听才能拿到）</li></ul> <h3 id="computed-有缓存"><a href="#computed-有缓存" class="header-anchor">#</a> computed 有缓存</h3> <ul><li>computed 有缓存，data 不变则缓存不失效</li> <li>methods 无缓存，实时计算</li></ul> <h3 id="答案"><a href="#答案" class="header-anchor">#</a> 答案</h3> <ul><li>computed 就已有数据产出新数据，有缓存</li> <li>watch 监听已有数据</li></ul> <h2 id="vue-组件通讯"><a href="#vue-组件通讯" class="header-anchor">#</a> Vue 组件通讯</h2> <h3 id="props-emit"><a href="#props-emit" class="header-anchor">#</a> props / $emit</h3> <p>适用于父子组件。</p> <ul><li>父组件向子组件传递 props 和事件</li> <li>子组件接收 props ，使用 <code>this.$emit</code> 调用事件</li></ul> <h3 id="自定义事件"><a href="#自定义事件" class="header-anchor">#</a> 自定义事件</h3> <p>适用于兄弟组件，或者“距离”较远的组件。</p> <p>常用 API</p> <ul><li>绑定事件 <code>event.on(key, fn)</code> 或 <code>event.once(key, fn)</code></li> <li>触发事件 <code>event.emit(key, data)</code></li> <li>解绑事件 <code>event.off(key, fn)</code></li></ul> <p>Vue 版本的区别</p> <ul><li>Vue 2.x 可以使用 Vue 实例作为自定义事件</li> <li>Vue 3.x 需要使用第三方的自定义事件，例如 https://www.npmjs.com/package/event-emitter</li></ul> <p>【注意】组件销毁时记得 <code>off</code> 事件，否则可能会造成内存泄漏</p> <h3 id="attrs"><a href="#attrs" class="header-anchor">#</a> $attrs</h3> <p><code>$attrs</code> 存储是父组件中传递过来的，且未在 <code>props</code> 和 <code>emits</code> 中定义的属性和事件。<br>
相当于 <code>props</code> 和 <code>emits</code> 的一个补充。</p> <p>继续向下级传递，可以使用 <code>v-bind=&quot;$attrs&quot;</code>。这会在下级组件中渲染 DOM 属性，可以用 <code>inheritAttrs: false</code> 避免。</p> <p>【注意】Vue3 中移除了 <code>$listeners</code> ，合并到了 <code>$attrs</code> 中。</p> <h3 id="parent"><a href="#parent" class="header-anchor">#</a> $parent</h3> <p>通过 <code>this.$parent</code> 可以获取父组件，并可以继续获取属性、调用方法等。</p> <p>【注意】Vue3 中移除了 <code>$children</code> ，建议使用 <code>$refs</code></p> <h3 id="refs"><a href="#refs" class="header-anchor">#</a> $refs</h3> <p>通过 <code>this.$refs.xxx</code> 可以获取某个子组件，前提是模板中要设置 <code>ref=&quot;xxx&quot;</code>。</p> <p>【注意】要在 <code>mounted</code> 中获取 <code>this.$refs</code> ，不能在 <code>created</code> 中获取。</p> <h3 id="provide-inject"><a href="#provide-inject" class="header-anchor">#</a> provide / inject</h3> <p>父子组件通讯方式非常多。如果是多层级的上下级组件通讯，可以使用 provide 和 inject 。<br>
在上级组件定一个 provide ，下级组件即可通过 inject 接收。</p> <ul><li>传递静态数据直接使用 <code>provide: { x: 10 }</code> 形式</li> <li>传递组件数据需要使用 <code>provide() { return { x: this.xx } }</code> 形式，但做不到响应式</li> <li>响应式需要借助 <code>computed</code> 来支持</li></ul> <h3 id="vuex"><a href="#vuex" class="header-anchor">#</a> Vuex</h3> <p>Vuex 全局数据管理</p> <h3 id="答案-2"><a href="#答案-2" class="header-anchor">#</a> 答案</h3> <ul><li>父子组件通讯
<ul><li><code>props</code> <code>emits</code> <code>this.$emit</code></li> <li><code>$attrs</code> （也可以通过 <code>v-bind=&quot;$attrs&quot;</code> 向下级传递）</li> <li><code>$parent</code> <code>$refs</code></li></ul></li> <li>多级组件上下级
<ul><li><code>provide</code> <code>inject</code></li></ul></li> <li>跨级、全局
<ul><li>自定义事件</li> <li>Vuex</li></ul></li></ul> <h2 id="vuex-mutation-action-区别"><a href="#vuex-mutation-action-区别" class="header-anchor">#</a> Vuex mutation action 区别</h2> <h3 id="答案-3"><a href="#答案-3" class="header-anchor">#</a> 答案</h3> <ul><li>mutation
<ul><li>建议原子操作，每次只修改一个数据，不要贪多</li> <li>必须是同步代码，方便查看 devTools 中的状态变化</li></ul></li> <li>action
<ul><li>可包含多个 mutation</li> <li>可以是异步操作</li></ul></li></ul> <p>Vue 每个生命周期都做了什么</p> <h2 id="vue-生命周期"><a href="#vue-生命周期" class="header-anchor">#</a> Vue 生命周期</h2> <p><img src="/assets/img/vue-lifecycle.bc5ef8df.png" alt=""></p> <h3 id="beforecreate"><a href="#beforecreate" class="header-anchor">#</a> beforeCreate</h3> <p>初始化一个空的 Vue 实例，<code>data</code> <code>methods</code> 等尚未被初始化，无法调用。</p> <h3 id="created"><a href="#created" class="header-anchor">#</a> created</h3> <p>Vue 实例初始化完成，<code>data</code> <code>methods</code> 都已初始化完成，可调用。<br>
但尚未开始渲染模板。</p> <h3 id="beforemount"><a href="#beforemount" class="header-anchor">#</a> beforeMount</h3> <p>编译模板，调用 <code>render</code> 函数生成 vdom ，但还没有开始渲染 DOM</p> <h3 id="mounted"><a href="#mounted" class="header-anchor">#</a> mounted</h3> <p>渲染 DOM 完成，页面更新。组件创建完成，开始进入运行阶段。</p> <h3 id="beforeupdate"><a href="#beforeupdate" class="header-anchor">#</a> beforeUpdate</h3> <p>在数据发生改变后，DOM 被更新之前被调用。这里适合在现有 DOM 将要被更新之前访问它，比如移除手动添加的事件监听器。</p> <h3 id="updated"><a href="#updated" class="header-anchor">#</a> updated</h3> <p>在数据更改导致的虚拟 DOM 重新渲染和更新完毕之后被调用。</p> <p>注意，尽量不要在 <code>updated</code> 中继续修改数据，否则可能会触发死循环。</p> <h3 id="onactivated"><a href="#onactivated" class="header-anchor">#</a> onActivated</h3> <p>被 <code>keep-alive</code> 缓存的组件激活时调用。</p> <h3 id="ondeactivated"><a href="#ondeactivated" class="header-anchor">#</a> onDeactivated</h3> <p>被 <code>keep-alive</code> 缓存的组件停用时调用。</p> <h3 id="beforeunmount"><a href="#beforeunmount" class="header-anchor">#</a> beforeUnmount</h3> <p>组件进入销毁阶段。</p> <p>卸载组件实例后调用，在这个阶段，实例仍然是完全正常的。<br>
移除、解绑一些全局事件、自定义事件，可以在此时操作。</p> <h3 id="unmounted"><a href="#unmounted" class="header-anchor">#</a> unmounted</h3> <p>卸载组件实例后调用。调用此钩子时，组件实例的所有指令都被解除绑定，所有事件侦听器都被移除，所有子组件实例被卸载。</p> <hr> <h3 id="连环问-如何正确的操作-dom"><a href="#连环问-如何正确的操作-dom" class="header-anchor">#</a> 连环问：如何正确的操作 DOM</h3> <p><code>mounted</code> 和 <code>updated</code> 都不会保证所有子组件都挂载完成，如果想等待所有视图都渲染完成，需要使用 <code>$nextTick</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 仅在整个视图都被渲染之后才会运行的代码</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="连环问-ajax-放在哪个生命周期合适"><a href="#连环问-ajax-放在哪个生命周期合适" class="header-anchor">#</a> 连环问：ajax 放在哪个生命周期合适？</h3> <p>一般有两个选择：<code>created</code> 和 <code>mounted</code> ，建议选择后者 <code>mounted</code> 。</p> <p>执行速度</p> <ul><li>从理论上来说，放在 <code>created</code> 确实会快一些</li> <li>但 ajax 是网络请求，其时间是主要的影响因素。从 <code>created</code> 到 <code>mounted</code> 是 JS 执行，速度非常快。</li> <li>所以，两者在执行速度上不会有肉眼可见的差距</li></ul> <p>代码的阅读和理解</p> <ul><li>放在 <code>created</code> 却会带来一些沟通和理解成本，从代码的执行上来看，它会一边执行组件渲染，一边触发网络请求，并行</li> <li>放在 <code>mounted</code> 就是等待 DOM 渲染完成再执行网络请求，串行，好理解</li></ul> <p>所以，综合来看，更建议选择 <code>mounted</code> 。</p> <h3 id="连环问-composition-api-生命周期有何不同"><a href="#连环问-composition-api-生命周期有何不同" class="header-anchor">#</a> 连环问：Composition API 生命周期有何不同</h3> <ul><li><code>setup</code> 代替了 <code>beforeCreate</code> 和 <code>created</code></li> <li>生命周期换成了函数的形式，如 <code>mounted</code> -&gt; <code>onMounted</code> 参考 https://v3.cn.vuejs.org/api/composition-api.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> onUpdated<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onUpdated</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'updated'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vue-router-模式"><a href="#vue-router-模式" class="header-anchor">#</a> Vue-router 模式</h2> <h3 id="v4-的升级"><a href="#v4-的升级" class="header-anchor">#</a> v4 的升级</h3> <p>Vue-router v4 升级之后，<code>mode: 'xxx'</code> 替换为 API 的形式，但功能是一样的</p> <ul><li><code>mode: 'hash'</code> 替换为 <code>createWebHashHistory()</code></li> <li><code>mode: 'history'</code> 替换为 <code>createWebHistory()</code></li> <li><code>mode: 'abstract'</code> 替换为 <code>createMemoryHistory()</code></li></ul> <p>PS：个人感觉，叫 <code>memory</code> 比叫 <code>abstract</code> 更易理解，前者顾名思义，后者就过于抽象。</p> <h3 id="hash"><a href="#hash" class="header-anchor">#</a> hash</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// http://127.0.0.1:8881/hash.html?a=100&amp;b=20#/aaa/bbb</span>
location<span class="token punctuation">.</span>protocol <span class="token comment">// 'http:'</span>
location<span class="token punctuation">.</span>hostname <span class="token comment">// '127.0.0.1'</span>
location<span class="token punctuation">.</span>host <span class="token comment">// '127.0.0.1:8881'</span>
location<span class="token punctuation">.</span>port <span class="token comment">// '8881'</span>
location<span class="token punctuation">.</span>pathname <span class="token comment">// '/hash.html'</span>
location<span class="token punctuation">.</span>search <span class="token comment">// '?a=100&amp;b=20'</span>
location<span class="token punctuation">.</span>hash <span class="token comment">// '#/aaa/bbb'</span>
</code></pre></div><p>hash 的特点</p> <ul><li>会触发页面跳转，可使用浏览器的“后退” “前进”</li> <li>但不会刷新页面，支持 SPA 必须的特性</li> <li>hash 不会被提交到 server 端（因此刷新页面也会命中当前页面，让前端根据 hash 处理路由）</li></ul> <p>url 中的 hash ，是不会发送给 server 端的。前端 <code>onhashchange</code> 拿到自行处理。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 页面初次加载，获取 hash</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hash'</span><span class="token punctuation">,</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// hash 变化，包括：</span>
<span class="token comment">// a. JS 修改 url</span>
<span class="token comment">// b. 手动修改 url 的 hash</span>
<span class="token comment">// c. 浏览器前进、后退</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onhashchange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'old url'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>oldURL<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'new url'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>newURL<span class="token punctuation">)</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hash'</span><span class="token punctuation">,</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="h5-history-api"><a href="#h5-history-api" class="header-anchor">#</a> H5 history API</h3> <p>常用的两个 API</p> <ul><li><code>history.pushState</code></li> <li><code>window.onpopstate</code></li></ul> <p>页面刷新时，<strong>服务端要做处理</strong>，可参考<a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90" target="_blank" rel="noopener noreferrer">文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。。即无论什么 url 访问 server ，都要返回该页面。</p> <p>按照 url 规范，不同的 url 对应不同的资源，例如：</p> <ul><li><code>https://github.com/</code> server 返回首页</li> <li><code>https://github.com/username/</code> server 返回用户页</li> <li><code>https://github.com/username/project1/</code> server 返回项目页</li></ul> <p>但是用了 SPA 的前端路由，就改变了这一规则，假如 github 用了的话：</p> <ul><li><code>https://github.com/</code> server 返回首页</li> <li><code>https://github.com/username/</code> server 返回首页，前端路由跳转到用户页</li> <li><code>https://github.com/username/project1/</code> server 返回首页，前端路由跳转到项目页</li></ul> <p>所以，从开发者的实现角度来看，前端路由是一个违反规则的形式。
但是从不关心后端，只关心前端页面的用户，或者浏览器来看，更喜欢 <code>pushState</code> 这种方式。</p> <p>代码参考 history-api.html</p> <h3 id="三种模式的区别"><a href="#三种模式的区别" class="header-anchor">#</a> 三种模式的区别</h3> <ul><li>hash - 使用 url hash 变化记录路由地址</li> <li>history - 使用 H5 history API 来改 url 记录路由地址</li> <li>abstract - 不修改 url ，路由地址在内存中，<strong>但页面刷新会重新回到首页</strong>。</li></ul> <h2 id="你在实际工作中-做过哪些-vue-优化"><a href="#你在实际工作中-做过哪些-vue-优化" class="header-anchor">#</a> 你在实际工作中，做过哪些 Vue 优化？</h2> <h3 id="v-if-和-v-show"><a href="#v-if-和-v-show" class="header-anchor">#</a> v-if 和 v-show</h3> <p>区别</p> <ul><li><code>v-if</code> 组件销毁/重建</li> <li><code>v-show</code> 组件隐藏（切换 CSS <code>display</code>）</li></ul> <p>场景</p> <ul><li>一般情况下使用 <code>v-if</code> 即可，普通组件的销毁、渲染不会造成性能问题</li> <li>如果组件创建时需要大量计算，或者大量渲染（如复杂的编辑器、表单、地图等），可以考虑 <code>v-show</code></li></ul> <h3 id="v-for-使用-key"><a href="#v-for-使用-key" class="header-anchor">#</a> v-for 使用 key</h3> <p><code>key</code> 可以优化内部的 diff 算法。注意，遍历数组时 <code>key</code> 不要使用 <code>index</code> 。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 而且，key 不要用 index --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(id, name) in list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="computed-缓存"><a href="#computed-缓存" class="header-anchor">#</a> computed 缓存</h3> <p><code>computed</code> 可以缓存计算结果，<code>data</code> 不变则缓存不失效。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">msgList</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token operator">...</span> <span class="token punctuation">]</span> <span class="token comment">// 消息列表</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 未读消息的数量</span>
        <span class="token function">unreadCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msgList<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=&gt;</span> m<span class="token punctuation">.</span>read <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="keep-alive"><a href="#keep-alive" class="header-anchor">#</a> keep-alive</h3> <p><code>&lt;keep-alive&gt;</code> 可以缓存子组件，只创建一次。通过 <code>activated</code> 和 <code>deactivated</code> 生命周期监听是否显示状态。<br>
代码参考 components/KeepAlive/index.vue</p> <p>场景</p> <ul><li>局部频繁切换的组件，如 tabs</li> <li>不可乱用 <code>&lt;keep-alive&gt;</code> ，缓存太多会占用大量内存，而且出问题不好 debug</li></ul> <h3 id="异步组件"><a href="#异步组件" class="header-anchor">#</a> 异步组件</h3> <p>对于体积大的组件（如编辑器、表单、地图等）可以使用异步组件</p> <ul><li>拆包，需要时异步加载，不需要时不加载</li> <li>减少 main 包的体积，页面首次加载更快</li></ul> <p>vue3 使用 <code>defineAsyncComponent</code> 加载异步组件，代码参考 components/AsyncComponent/index.vue</p> <h3 id="路由懒加载"><a href="#路由懒加载" class="header-anchor">#</a> 路由懒加载</h3> <p>对于一些补偿访问的路由，或者组件提交比较大的路由，可以使用路由懒加载。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Home<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'About'</span><span class="token punctuation">,</span>
    <span class="token comment">// 路由懒加载</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;about&quot; */</span> <span class="token string">'../views/About.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="ssr"><a href="#ssr" class="header-anchor">#</a> SSR</h3> <p>SSR 让网页访问速度更快，对 SEO 友好。</p> <p>但 SSR 使用和调试成本高，不可乱用。例如，一个低代码项目（在线制作 H5 网页），toB 部分不可用 SSR ， toC 部分适合用 SSR 。</p> <h3 id="答案-4"><a href="#答案-4" class="header-anchor">#</a> 答案</h3> <ul><li>v-if 和 v-show</li> <li>v-for 使用 key</li> <li>computed 缓存</li> <li>keep-alive</li> <li>异步组件</li> <li>路由懒加载</li> <li>SSR</li></ul> <h2 id="连环问-vue-遇到过哪些坑"><a href="#连环问-vue-遇到过哪些坑" class="header-anchor">#</a> 连环问：Vue 遇到过哪些坑？？？</h2> <p>全局事件、自定义事件要在组件销毁时解除绑定</p> <ul><li>内存泄漏风险</li> <li>全局事件（如 <code>window.resize</code>）不解除，则会继续监听，而且组件再次创建时会重复绑定</li></ul> <p>Vue2.x 中，无法监听 data 属性的新增和删除，以及数组的部分修改 —— Vue3 不会有这个问题</p> <ul><li>新增 data 属性，需要用 <code>Vue.set</code></li> <li>删除 data 属性，需要用 <code>Vue.delete</code></li> <li>修改数组某一元素，不能 <code>arr[index] = value</code> ，要使用 <code>arr.splice</code> API 方式</li></ul> <p>路由切换时，页面会 scroll 到顶部。例如，在一个新闻列表页下滑到一定位置，点击进入详情页，在返回列表页，此时会 scroll 到顶部，并重新渲染列表页。所有的 SPA 都会有这个问题，并不仅仅是 Vue 。</p> <ul><li>在列表页缓存数据和 <code>scrollTop</code></li> <li>返回列表页时（用 Vue-router <a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html" target="_blank" rel="noopener noreferrer">导航守卫<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，判断 <code>from</code>），使用缓存数据渲染页面，然后 <code>scrollTo(scrollTop)</code></li></ul> <h2 id="vue-错误监听"><a href="#vue-错误监听" class="header-anchor">#</a> Vue 错误监听</h2> <h3 id="window-onerror"><a href="#window-onerror" class="header-anchor">#</a> window.onerror</h3> <p>可以监听当前页面所有的 JS 报错，jQuery 时代经常用。<br>
注意，全局只绑定一次即可。不要放在多次渲染的组件中，这样容易绑定多次。</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> source<span class="token punctuation">,</span> line<span class="token punctuation">,</span> column<span class="token punctuation">,</span> error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'window.onerror---------'</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> source<span class="token punctuation">,</span> line<span class="token punctuation">,</span> column<span class="token punctuation">,</span> error<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 注意，如果用 window.addEventListener('error', event =&gt; {}) 参数不一样！！！</span>
</code></pre></div><h3 id="errorcaptured-生命周期"><a href="#errorcaptured-生命周期" class="header-anchor">#</a> errorCaptured 生命周期</h3> <p>会监听所有<strong>下级组件</strong>的错误。可以返回 <code>false</code> 阻止向上传播，因为可能会有多个上级节点都监听错误。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">errorCaptured</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'errorCaptured--------'</span><span class="token punctuation">,</span> error<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> info<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="errorhandler"><a href="#errorhandler" class="header-anchor">#</a> errorHandler</h3> <p>全局的错误监听，所有组件的报错都会汇总到这里来。PS：如果 <code>errorCaptured</code> 返回 <code>false</code> 则<strong>不会</strong>到这里。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function-variable function">errorHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'errorHandler--------'</span><span class="token punctuation">,</span> error<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> info<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>请注意，<code>errorHandler</code> 会阻止错误走向 <code>window.onerror</code>。</p> <p>PS：还有 <code>warnHandler</code></p> <h3 id="异步错误"><a href="#异步错误" class="header-anchor">#</a> 异步错误</h3> <p>组件内的异步错误 <code>errorHandler</code> 监听不到，还是需要 <code>window.onerror</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'setTimeout 报错'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="答案-5"><a href="#答案-5" class="header-anchor">#</a> 答案</h3> <p>方式</p> <ul><li><code>errorCaptured</code> 监听下级组件的错误，可返回 <code>false</code> 阻止向上传播</li> <li><code>errorHandler</code> 监听 Vue 全局错误</li> <li><code>window.onerror</code> 监听其他的 JS 错误，如异步</li></ul> <p>建议：结合使用</p> <ul><li>一些重要的、复杂的、有运行风险的组件，可使用 <code>errorCaptured</code> 重点监听</li> <li>然后用 <code>errorHandler</code> <code>window.onerror</code> 候补全局监听，避免意外情况</li></ul> <h3 id="扩展"><a href="#扩展" class="header-anchor">#</a> 扩展</h3> <p>Promise 监听报错要使用 <code>window.onunhandledrejection</code></p> <h2 id="谈一下你对-mvvm-原理的理解"><a href="#谈一下你对-mvvm-原理的理解" class="header-anchor">#</a> 谈一下你对 mvvm 原理的理解</h2> <ol><li>传统的 MVC 指的是,用户操作会请求服务端路由，路由会调用对应的控制器来处理,控制器会获取数
据。将结果返回给前端,页面重新渲染</li> <li>MVVM :传统的前端会将数据手动渲染到页面上, MVVM 模式不需要用户收到操作 dom 元素,将数据绑
定到 viewModel 层上，会自动将数据渲染到页面中，视图变化会通知 viewModel 层 更新数据。
ViewModel 就是我们 MVVM 模式中的桥梁.</li></ol> <h2 id="请说一下-vue2-响应式数据的原理"><a href="#请说一下-vue2-响应式数据的原理" class="header-anchor">#</a> 请说一下 vue2 响应式数据的原理？</h2> <ol><li>核心点: Object.defineProperty</li> <li>默认 Vue 在初始化数据时，会给 data 中的属性使用 Object.defineProperty 重新定义所有属性,当页面取到对应属性时。会进行依赖收集（收集当前组件的 watcher） 如果属性发生变化会通知相关依赖进行更新操作。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reactiveGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> getter <span class="token operator">?</span> <span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span> val
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ** 收集依赖     ** /</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>childOb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        childOb<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">dependArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reactiveSetter</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> getter <span class="token operator">?</span> <span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span> val
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">===</span> value <span class="token operator">||</span> <span class="token punctuation">(</span>newVal <span class="token operator">!==</span> newVal <span class="token operator">&amp;&amp;</span> value <span class="token operator">!==</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> customSetter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">customSetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    val <span class="token operator">=</span> newVal
    childOb <span class="token operator">=</span> <span class="token operator">!</span>shallow <span class="token operator">&amp;&amp;</span> <span class="token function">observe</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span>
    dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">/**通知相关依赖进行更新**/</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="vue2-中是如何检测数组变化"><a href="#vue2-中是如何检测数组变化" class="header-anchor">#</a> vue2 中是如何检测数组变化?</h2> <ol><li>使用函数劫持的方式，重写了数组的方法</li> <li>Vue 将 data 中的数组，进行了原型链重写。指向了自己定义的数组原型方法，这样当调用数组 api 时，可以通知依赖更新.如果数组中包含着引用类型。会对数组中的引用类型再次进行监控。</li></ol> <p><img src="/assets/img/vue2-array-apply.ba1d77f9.png" alt=""></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arrayProto <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype
<span class="token keyword">export</span> <span class="token keyword">const</span> arrayMethods <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>arrayProto<span class="token punctuation">)</span>
<span class="token keyword">const</span> methodsToPatch <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'push'</span><span class="token punctuation">,</span>
  <span class="token string">'pop'</span><span class="token punctuation">,</span>
  <span class="token string">'shift'</span><span class="token punctuation">,</span>
  <span class="token string">'unshift'</span><span class="token punctuation">,</span>
  <span class="token string">'splice'</span><span class="token punctuation">,</span>
  <span class="token string">'sort'</span><span class="token punctuation">,</span>
  <span class="token string">'reverse'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
methodsToPatch<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 重写原型方法</span>
  <span class="token keyword">const</span> original <span class="token operator">=</span> arrayProto<span class="token punctuation">[</span>method<span class="token punctuation">]</span> <span class="token comment">// 调用原数组的方法</span>
  <span class="token function">def</span><span class="token punctuation">(</span>arrayMethods<span class="token punctuation">,</span> method<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">mutator</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">original</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">const</span> ob <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__ob__
    <span class="token keyword">let</span> inserted
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'push'</span><span class="token operator">:</span>
      <span class="token keyword">case</span> <span class="token string">'unshift'</span><span class="token operator">:</span>
        inserted <span class="token operator">=</span> args
        <span class="token keyword">break</span>
      <span class="token keyword">case</span> <span class="token string">'splice'</span><span class="token operator">:</span>
        inserted <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>inserted<span class="token punctuation">)</span> ob<span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>inserted<span class="token punctuation">)</span> <span class="token comment">// notify change</span>
    ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 当调用数组方法后，手动通知视图更新</span>
    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment">// 进行深度监控</span>
</code></pre></div><h2 id="为什么-vue2-采用异步渲染"><a href="#为什么-vue2-采用异步渲染" class="header-anchor">#</a> 为什么 vue2 采用异步渲染?</h2> <p>因为如果不采用异步更新，那么每次更新数据都会对当前组件进行重新渲染.所以为了性能考虑。 Vue 会在本轮数据更新后，再去异步更新视图</p> <p><img src="/assets/img/async-render.b32b8390.png" alt=""></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">update</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">/* istanbul ignore else */</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lazy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">true</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
     <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 当数据发生变化时会将watcher放到一个队列中批量更新</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">queueWatcher</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">watcher</span><span class="token operator">:</span> Watcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id <span class="token comment">// 会对相同的watcher进行过滤</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flushing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> i <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
     <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> index <span class="token operator">&amp;&amp;</span> queue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">&gt;</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       i<span class="token operator">--</span>
    <span class="token punctuation">}</span>
     queue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> watcher<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
   <span class="token comment">// queue the flush</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>waiting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     waiting <span class="token operator">=</span> <span class="token boolean">true</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>config<span class="token punctuation">.</span>async<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">flushSchedulerQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
     <span class="token function">nextTick</span><span class="token punctuation">(</span>flushSchedulerQueue<span class="token punctuation">)</span> <span class="token comment">// 调用nextTick方法     批量的进行更新</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="nexttick-实现原理"><a href="#nexttick-实现原理" class="header-anchor">#</a> nextTick 实现原理?</h2> <p>nextTick 方法主要是使用了宏任务和微任务,定义了一个异步方法.多次调用 nextTick 会将方法存入队列中，通过这个异步方法清空当前队列。所以这个 nextTick 方法就是异步方法</p> <p><img src="/assets/img/nexttick.84af092e.png" alt=""></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> timerFunc  <span class="token comment">// 会定义一个异步方法</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Promise <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isNative</span><span class="token punctuation">(</span>Promise<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// promise</span>
 <span class="token keyword">const</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>isIOS<span class="token punctuation">)</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>noop<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
 isUsingMicroTask <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isIE <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> MutationObserver <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token comment">//</span>
MutationObserver
 <span class="token function">isNative</span><span class="token punctuation">(</span>MutationObserver<span class="token punctuation">)</span> <span class="token operator">||</span>
 MutationObserver<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object MutationObserverConstructor]'</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">1</span>
 <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>
 <span class="token keyword">const</span> textNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">)</span>
 observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>textNode<span class="token punctuation">,</span> <span class="token punctuation">{</span>
   characterData<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   counter <span class="token operator">=</span> <span class="token punctuation">(</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span>
   textNode<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
 isUsingMicroTask <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> setImmediate <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// setImmediate</span>
 <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">setImmediate</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
 <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>   <span class="token comment">// setTimeout</span>
   <span class="token function">setTimeout</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// nextTick实现</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">nextTick</span> <span class="token punctuation">(</span><span class="token parameter">cb<span class="token operator">?</span><span class="token operator">:</span> Function<span class="token punctuation">,</span> ctx<span class="token operator">?</span><span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> _resolve
 callbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
     <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> <span class="token string">'nextTick'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_resolve<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">_resolve</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pending<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   pending <span class="token operator">=</span> <span class="token boolean">true</span>
   <span class="token function">timerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vue2-中的-computed-的特点"><a href="#vue2-中的-computed-的特点" class="header-anchor">#</a> vue2 中的 Computed 的特点？</h2> <p>默认 computed 也是一个 watcher 是具备缓存的，只要当依赖的属性发生变化时才会更新视图</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">initComputed</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">vm</span><span class="token operator">:</span> Component<span class="token punctuation">,</span> <span class="token literal-property property">computed</span><span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> watchers <span class="token operator">=</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_computedWatchers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> isSSR <span class="token operator">=</span> <span class="token function">isServerRendering</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> userDef <span class="token operator">=</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">const</span> getter <span class="token operator">=</span> <span class="token keyword">typeof</span> userDef <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> userDef <span class="token operator">:</span> userDef<span class="token punctuation">.</span>get
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSSR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// create internal watcher for the computed property.</span>
      watchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>
        vm<span class="token punctuation">,</span>
        getter <span class="token operator">||</span> noop<span class="token punctuation">,</span>
        noop<span class="token punctuation">,</span>
        computedWatcherOptions
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token comment">// component-defined computed properties are already defined on the // component prototype. We only need to define computed properties defined // at instantiation here.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> vm<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">defineComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> userDef<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> vm<span class="token punctuation">.</span>$data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; is already defined in data.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>props <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; is already defined as a prop.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">createComputedGetter</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">computedGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>dirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果依赖的值没发生变化,就不会重新求值</span>
        watcher<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> watcher<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="何时需要使用-beforedestroy"><a href="#何时需要使用-beforedestroy" class="header-anchor">#</a> 何时需要使用 beforeDestroy</h2> <p>可能在当前页面中使用了 $on 方法，那需要在组件销毁前解绑。
清除自己定义的定时器
解除事件的绑定 scroll mousemove ....</p> <h2 id="vue-中模板编译原理"><a href="#vue-中模板编译原理" class="header-anchor">#</a> vue 中模板编译原理</h2> <p>将 template 转化成 render 函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">baseCompile</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">template</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">options</span><span class="token operator">:</span> CompilerOptions</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ast <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>template<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token comment">// 1.将模板转化成ast语法树</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>optimize <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2.优化树</span>
    <span class="token function">optimize</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token comment">// 3.生成树</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    ast<span class="token punctuation">,</span>
    <span class="token literal-property property">render</span><span class="token operator">:</span> code<span class="token punctuation">.</span>render<span class="token punctuation">,</span>
    <span class="token literal-property property">staticRenderFns</span><span class="token operator">:</span> code<span class="token punctuation">.</span>staticRenderFns<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ncname <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[a-zA-Z_][\\-\\.0-9_a-zA-Z]*</span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">const</span> qnameCapture <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">((?:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ncname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\:)?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ncname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">const</span> startTagOpen <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">^&lt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>qnameCapture<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// 标签开头的正则     捕获的内容是标签名</span>
<span class="token keyword">const</span> endTag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">^&lt;\\/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>qnameCapture<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">[^&gt;]*&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// 匹配标签结尾的         &lt;/div&gt;</span>
<span class="token keyword">const</span> attribute <span class="token operator">=</span>
  <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s*([^\s&quot;'&lt;&gt;\/=]+)(?:\s*(=)\s*(?:&quot;([^&quot;]*)&quot;+|'([^']*)'+|([^\s&quot;'=&lt;&gt;`]+)))?</span><span class="token regex-delimiter">/</span></span> <span class="token comment">// 匹配属性的</span>
<span class="token keyword">const</span> startTagClose <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s*(\/?)&gt;</span><span class="token regex-delimiter">/</span></span> <span class="token comment">// 匹配标签结束的         &gt;</span>
<span class="token keyword">let</span> root
<span class="token keyword">let</span> currentParent
<span class="token keyword">let</span> stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">function</span> <span class="token function">createASTElement</span><span class="token punctuation">(</span><span class="token parameter">tagName<span class="token punctuation">,</span> attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> tagName<span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    attrs<span class="token punctuation">,</span>
    <span class="token literal-property property">parent</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">tagName<span class="token punctuation">,</span> attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> element <span class="token operator">=</span> <span class="token function">createASTElement</span><span class="token punctuation">(</span>tagName<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    root <span class="token operator">=</span> element
  <span class="token punctuation">}</span>
  currentParent <span class="token operator">=</span> element
  stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">chars</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  currentParent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    text<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">tagName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> stack<span class="token punctuation">[</span>stack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
  stack<span class="token punctuation">.</span>length<span class="token operator">--</span>
  currentParent <span class="token operator">=</span> stack<span class="token punctuation">[</span>stack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>currentParent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>parent <span class="token operator">=</span> currentParent
    currentParent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">parseHTML</span><span class="token punctuation">(</span><span class="token parameter">html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>html<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> textEnd <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>textEnd <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> startTagMatch <span class="token operator">=</span> <span class="token function">parseStartTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>startTagMatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">start</span><span class="token punctuation">(</span>startTagMatch<span class="token punctuation">.</span>tagName<span class="token punctuation">,</span> startTagMatch<span class="token punctuation">.</span>attrs<span class="token punctuation">)</span>
        <span class="token keyword">continue</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> endTagMatch <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>endTag<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>endTagMatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">advance</span><span class="token punctuation">(</span>endTagMatch<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
        <span class="token function">end</span><span class="token punctuation">(</span>endTagMatch<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> text
    <span class="token keyword">if</span> <span class="token punctuation">(</span>textEnd <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      text <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> textEnd<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">advance</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
      <span class="token function">chars</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">advance</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">parseStartTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> start <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>startTagOpen<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>start<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">tagName</span><span class="token operator">:</span> start<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      <span class="token function">advance</span><span class="token punctuation">(</span>start<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
      <span class="token keyword">let</span> attr<span class="token punctuation">,</span> end
      <span class="token keyword">while</span> <span class="token punctuation">(</span>
        <span class="token operator">!</span><span class="token punctuation">(</span>end <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>startTagClose<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>attr <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>attribute<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">advance</span><span class="token punctuation">(</span>attr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
        match<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> attr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> attr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">advance</span><span class="token punctuation">(</span>end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
        <span class="token keyword">return</span> match
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 生成语法树</span>
<span class="token function">parseHTML</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div id=&quot;container&quot;&gt;&lt;p&gt;hello&lt;span&gt;zf&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">generate</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_v(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">genChildren</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> children <span class="token operator">=</span> el<span class="token punctuation">.</span>children
  <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">gen</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">genProps</span><span class="token punctuation">(</span><span class="token parameter">attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> attrs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> attr <span class="token operator">=</span> attrs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>attr<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>attr<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{attrs:{</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}}</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> children <span class="token operator">=</span> <span class="token function">genChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
  <span class="token keyword">let</span> code <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_c('</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>el<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>el<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">genProps</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>attrs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
    children <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>children<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">''</span>
  <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">return</span> code
<span class="token punctuation">}</span>
<span class="token comment">// 根据语法树生成新的代码</span>
<span class="token keyword">let</span> code <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
<span class="token keyword">let</span> render <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">with(this){return </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}</span><span class="token template-punctuation string">`</span></span>
<span class="token comment">// 包装成函数</span>
<span class="token keyword">let</span> renderFn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>renderFn<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="vue-中-v-if-和-v-show-的区别"><a href="#vue-中-v-if-和-v-show-的区别" class="header-anchor">#</a> Vue 中 v-if 和 V-show 的区别?</h2> <ol><li>v-if 如果条件不成立不会渲染当前指令所在节点的 dom 元素</li> <li>v-show 只是切换当前 dom 的显示或者隐藏</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> VueTemplateCompiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-template-compiler'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> r1 <span class="token operator">=</span> VueTemplateCompiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div v-if=&quot;true&quot;&gt;&lt;span v-for=&quot;i in 
3&quot;&gt;hello&lt;/span&gt;&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token comment">/**
with(this) {
   return (true) ? _c('div', _l((3), function (i) { 
       return _c('span', [_v(&quot;hello&quot;)])
   }), 0) : _e() 
}
*/</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> VueTemplateCompiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-template-compiler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> r2 <span class="token operator">=</span> VueTemplateCompiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div v-show=&quot;true&quot;&gt;&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
with(this) {
   return _c('div', {
       directives: [{
           name: &quot;show&quot;,
           rawName: &quot;v-show&quot;,
           value: (true),
           expression: &quot;true&quot;
       }]
   })
}
*/</span>
<span class="token comment">// v-show 操作的是样式         定义在platforms/web/runtime/directives/show.js</span>
<span class="token function">bind</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token operator">:</span> VNodeDirective<span class="token punctuation">,</span> <span class="token literal-property property">vnode</span><span class="token operator">:</span> VNodeWithData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   vnode <span class="token operator">=</span> <span class="token function">locateNode</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>
   <span class="token keyword">const</span> transition <span class="token operator">=</span> vnode<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>transition
   <span class="token keyword">const</span> originalDisplay <span class="token operator">=</span> el<span class="token punctuation">.</span>__vOriginalDisplay <span class="token operator">=</span>
     el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">===</span> <span class="token string">'none'</span> <span class="token operator">?</span> <span class="token string">''</span> <span class="token operator">:</span> el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display
   <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&amp;&amp;</span> transition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     vnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">true</span>
     <span class="token function">enter</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
       el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> originalDisplay
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
     el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> value <span class="token operator">?</span> originalDisplay <span class="token operator">:</span> <span class="token string">'none'</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="为什么-v-for-和-v-if-不能连用"><a href="#为什么-v-for-和-v-if-不能连用" class="header-anchor">#</a> 为什么 V-for 和 v-if 不能连用</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> VueTemplateCompiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-template-compiler'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> r1 <span class="token operator">=</span> VueTemplateCompiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div v-if=&quot;false&quot; v-for=&quot;i in 
3&quot;&gt;hello&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token comment">/**
with(this) {
   return _l((3), function (i) {
       return (false) ? _c('div', [_v(&quot;hello&quot;)]) : _e() 
   })
} 
*/</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">.</span>render<span class="token punctuation">)</span>
</code></pre></div><p>v-for 会比 v-if 的优先级高一些,如果连用的话会把 v-if 给每个元素都添加一下,会造成性能问题</p> <h2 id="用-vnode-来描述一个-dom-结构"><a href="#用-vnode-来描述一个-dom-结构" class="header-anchor">#</a> 用 vnode 来描述一个 DOM 结构?</h2> <p>虚拟节点就是用一个对象来描述真实的 dom 元素</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">$createElement</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token operator">...</span>children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> key <span class="token operator">=</span> data<span class="token punctuation">.</span>key
  <span class="token keyword">delete</span> data<span class="token punctuation">.</span>key
  children <span class="token operator">=</span> children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">child</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> child
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">vnode</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> child<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">vnode</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> props<span class="token punctuation">,</span> key<span class="token punctuation">,</span> children<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">vnode</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> children<span class="token punctuation">,</span> text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    tag<span class="token punctuation">,</span> <span class="token comment">// 表示的是当前的标签名</span>
    data<span class="token punctuation">,</span> <span class="token comment">// 表示的是当前标签上的属性</span>
    key<span class="token punctuation">,</span> <span class="token comment">// 唯一表示用户可能传递</span>
    children<span class="token punctuation">,</span>
    text<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vue2-diff-算法的时间复杂度"><a href="#vue2-diff-算法的时间复杂度" class="header-anchor">#</a> vue2 diff 算法的时间复杂度</h2> <p>两个树的完全的 diff 算法是一个时间复杂度为 o(n3),Vue 进行了优化:0(n3) 复杂的问题转换成 O(n)复杂的问题(只比较同级不考虑跨级问题)在前端当中 ，你很少会跨越层级地移动 Dom 元素。所以 Virtual Dom 只会对同一个层级的元素进行对比。</p> <h2 id="简述-vue2-中-diff-算法原理"><a href="#简述-vue2-中-diff-算法原理" class="header-anchor">#</a> 简述 Vue2 中 diff 算法原理</h2> <ol><li>先同级比较，在比较子节点</li> <li>先判断一方有儿子一方没儿子的情况</li> <li>比较都有儿子的情况</li> <li>递归比较子节点</li></ol> <p><img src="/assets/img/vue2-diff.e72f9323.png" alt=""></p> <h2 id="v-for-中为什么要用-key"><a href="#v-for-中为什么要用-key" class="header-anchor">#</a> V-for 中为什么要用 key?</h2> <ol><li><p>vue 中列表循环需加:key=“唯一标识” 唯一标识尽量是 item 里面 id 等，因为 vue 组件高度复用增加 Key 可以标识组件的唯一性，为了更好地区别各个组件 key 的作用主要是为了高效的更新虚拟 DOM。</p></li> <li><p>key 主要用来做 dom diff 算法用的，diff 算法是同级比较，比较当前标签上的 key 还有它当前的标签名，如果 key 和标签名都一样时只是做了一个移动的操作，不会重新创建元素和删除元素。</p></li> <li><p>没有 key 的时候默认使用的是“就地复用”策略。如果数据项的顺序被改变，Vue 不是移动 Dom 元素来匹配数据项的改变，而是简单复用原来位置的每个元素。如果删除第一个元素，在进行比较时发现标签一样值不一样时，就会复用之前的位置，将新值直接放到该位置，以此类推，最后多出一个就会把最后一个删除掉。</p></li> <li><p>尽量不要使用索引值 index 作 key 值，一定要用唯一标识的值，如 id 等。因为若用数组索引 index 为 key，当向数组中指定位置插入一个新元素后，因为这时候会重新更新 index 索引，对应着后面的虚拟 DOM 的 key 值全部更新了，这个时候还是会做不必要的更新，就像没有加 key 一样，因此 index 虽然能够解决 key 不冲突的问题，但是并不能解决复用的情况。如果是静态数据，用索引号 index 做 key 值是没有问题的。</p></li> <li><p>标签名一样，key 一样这时候就会就地复用，如果标签名不一样，key 一样不会复用。</p></li></ol> <h2 id="描述-vue2-组件渲染和更新过程"><a href="#描述-vue2-组件渲染和更新过程" class="header-anchor">#</a> 描述 vue2 组件渲染和更新过程</h2> <p>渲染组件时，会通过 vue.extend 方法构建子组件的构造函数，并进行实例化。最终手动调用$mount()进行挂载。更新组件时会进行 patchvnode 流程核心就是 diff 算法</p> <p><img src="/assets/img/vue2-com-mounted.90b33638.png" alt=""></p> <h2 id="vue2-组件中的-data-为什么是一个函数"><a href="#vue2-组件中的-data-为什么是一个函数" class="header-anchor">#</a> vue2 组件中的 data 为什么是一个函数?</h2> <p>同一个组件被复用多次，会创建多个实例。这些实例用的是同一个构造函数，如果 data 是一个对象的话。那么所有组件都共享了同一个对象。为了保证组件的数据独立性要求每个组件必须通过 data 函数返回一个对象作为组件的状态。</p> <blockquote><p>一个组件被使用多次，用的都是同一个构造函数。为了保证组件的不同的实例 data 不冲突，要求 data 必须是一个函数，这样组件间不会相互影响</p></blockquote> <h2 id="vue2-中事件绑定的原理"><a href="#vue2-中事件绑定的原理" class="header-anchor">#</a> vue2 中事件绑定的原理</h2> <p>vue 的事件绑定分为两种一种是原生的事件绑定，还有一种是组件的事件绑定</p> <ol><li>原生 dom 事件的绑定,采用的是 addEventListener 实现</li> <li>组件绑定事件采用的是 $on 方法</li></ol> <p>事件的编译原理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> compiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-template-compiler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> r1 <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">'&lt;div @click=&quot;fn()&quot;&gt;&lt;/div&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> r2 <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>'<span class="token operator">&lt;</span>my<span class="token operator">-</span>component @click<span class="token punctuation">.</span>native<span class="token operator">=</span><span class="token string">&quot;fn&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;fn1&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>
component<span class="token operator">&gt;</span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {on:{click}}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {nativeOnOn:{click},on:{click}}  </span>
</code></pre></div><p><img src="/assets/img/com-event.756a10fa.png" alt=""></p> <h2 id="v-model-的实现原理及如何自定义"><a href="#v-model-的实现原理及如何自定义" class="header-anchor">#</a> v-model 的实现原理及如何自定义</h2> <p>v-mode1 可以看成是 value+input 方法 的语法糖</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-checkbox</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-checkbox</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-checkbox</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>check<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-checkbox</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>可以自己重新定义 v-model 的含义</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'el-checkbox'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;input type=&quot;checkbox&quot; :checked=&quot;check&quot; 
@change=&quot;$emit('change',$event.target.checked)&quot;&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">prop</span><span class="token operator">:</span> <span class="token string">'check'</span><span class="token punctuation">,</span> <span class="token comment">// 更改默认的value的名字</span>
    <span class="token literal-property property">event</span><span class="token operator">:</span> <span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token comment">// 更改默认的方法名</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">check</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="sync-修饰符的原理"><a href="#sync-修饰符的原理" class="header-anchor">#</a> .sync 修饰符的原理</h2> <div class="language-html extra-class"><pre class="language-html"><code>// 正常父传子：
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>com1</span> <span class="token attr-name">:a</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:b</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>com1</span><span class="token punctuation">&gt;</span></span>

// 加上sync之后父传子：
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>com1</span> <span class="token attr-name">:a.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num<span class="token punctuation">&quot;</span></span> <span class="token attr-name">.b.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>com1</span><span class="token punctuation">&gt;</span></span>

// 它等价于
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>com1</span>
  <span class="token attr-name">:a</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">@update:</span>a</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>val=&gt;num=val<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:b</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num2<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">@update:</span>b</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>val=&gt;num2=val<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>com1</span><span class="token punctuation">&gt;</span></span>

//
相当于多了一个事件监听，事件名是update:a，回调函数中，会把接收到的值赋值给属性绑定的数据项中。
</code></pre></div><h2 id="sync-与-v-model-区别"><a href="#sync-与-v-model-区别" class="header-anchor">#</a> .sync 与 v-model 区别</h2> <p>相同点：都是语法糖，都可以实现父子组件中的数据的双向通信。
区别点：</p> <ul><li>格式不同。 v-model=“num”, :num.sync=“num”</li> <li>v-model： @input + value</li> <li>:num.sync: @update:num</li> <li>v-model 只能用一次；.sync 可以有多个。</li></ul> <h2 id="vue-中-v-html-会导致哪些问题"><a href="#vue-中-v-html-会导致哪些问题" class="header-anchor">#</a> Vue 中 v-html 会导致哪些问题?</h2> <ol><li>可能会导致 xss 攻击</li> <li>v-html 会替换掉标签内部的子元素</li></ol> <h2 id="vue-父子组件生命周期调用顺序"><a href="#vue-父子组件生命周期调用顺序" class="header-anchor">#</a> vue 父子组件生命周期调用顺序</h2> <ol><li><p>加载渲染过程
父 beforeCreate-&gt;父 created-&gt;父 beforeMount-&gt;子 beforeCreate-&gt;子 created-&gt;子 beforeMount-&gt;子 mounted-&gt;父 mounted</p></li> <li><p>子组件更新过程
父 beforeUpdate-&gt;子 beforeUpdate-&gt;子 updated-&gt;父 updated</p></li> <li><p>父组件更新过程
父 beforeUpdate-&gt;父 updated</p></li> <li><p>销毁过程
父 beforeDestroy-&gt;子 beforeDestroy-&gt;子 destroyed-&gt;父 destroyed</p></li></ol> <h2 id="为什么要使用异步组件"><a href="#为什么要使用异步组件" class="header-anchor">#</a> 为什么要使用异步组件 ?</h2> <p>如果组件功能多打包出的结果会变大，我可以采用异步的方式来加载组件。主要依赖 import() 这
个语法，可以实现文件的分割加载。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">AddCustomerSchedule</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../components/AddCustomer'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span>  <span class="token punctuation">(</span>
 <span class="token parameter"><span class="token literal-property property">Ctor</span><span class="token operator">:</span> Class<span class="token operator">&lt;</span>Component<span class="token operator">&gt;</span> <span class="token operator">|</span> Function <span class="token operator">|</span> Object <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
 data<span class="token operator">:</span> <span class="token operator">?</span>VNodeData<span class="token punctuation">,</span>
 context<span class="token operator">:</span> Component<span class="token punctuation">,</span>
 children<span class="token operator">:</span> <span class="token operator">?</span>Array<span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
 tag<span class="token operator">?</span><span class="token operator">:</span> string</span>
<span class="token punctuation">)</span><span class="token operator">:</span> VNode <span class="token operator">|</span> Array<span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
 <span class="token comment">// async component</span>
 <span class="token keyword">let</span> asyncFactory
 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>Ctor<span class="token punctuation">.</span>cid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   asyncFactory <span class="token operator">=</span> Ctor
   Ctor <span class="token operator">=</span> <span class="token function">resolveAsyncComponent</span><span class="token punctuation">(</span>asyncFactory<span class="token punctuation">,</span> baseCtor<span class="token punctuation">)</span> <span class="token comment">// 默认调用此函数时返回undefiend</span>
   <span class="token comment">// 第二次渲染时Ctor不为undefined</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>Ctor <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token function">createAsyncPlaceholder</span><span class="token punctuation">(</span> <span class="token comment">// 渲染占位符     空虚拟节点</span>
       asyncFactory<span class="token punctuation">,</span>
       data<span class="token punctuation">,</span>
       context<span class="token punctuation">,</span>
       children<span class="token punctuation">,</span>
       tag
    <span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">resolveAsyncComponent</span> <span class="token punctuation">(</span>
 <span class="token parameter"><span class="token literal-property property">factory</span><span class="token operator">:</span> Function<span class="token punctuation">,</span>
 baseCtor<span class="token operator">:</span> Class<span class="token operator">&lt;</span>Component<span class="token operator">&gt;</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> Class<span class="token operator">&lt;</span>Component<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>factory<span class="token punctuation">.</span>resolved<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 3.在次渲染时可以拿到获取的最新组件</span>
   <span class="token keyword">return</span> factory<span class="token punctuation">.</span>resolved
<span class="token punctuation">}</span>
 <span class="token keyword">const</span> resolve <span class="token operator">=</span> <span class="token function">once</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">res</span><span class="token operator">:</span> Object <span class="token operator">|</span> Class<span class="token operator">&lt;</span>Component<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     factory<span class="token punctuation">.</span>resolved <span class="token operator">=</span> <span class="token function">ensureCtor</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> baseCtor<span class="token punctuation">)</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">forceRender</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">//2. 强制更新视图重新渲染</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
       owners<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> reject <span class="token operator">=</span> <span class="token function">once</span><span class="token punctuation">(</span><span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>factory<span class="token punctuation">.</span>errorComp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         factory<span class="token punctuation">.</span>error <span class="token operator">=</span> <span class="token boolean">true</span>
         <span class="token function">forceRender</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token comment">// 1.将resolve方法和reject方法传入，用户调用resolve方法后</span>
 sync <span class="token operator">=</span> <span class="token boolean">false</span>
 <span class="token keyword">return</span> factory<span class="token punctuation">.</span>resolved
<span class="token punctuation">}</span>
</code></pre></div><h2 id="什么是插槽"><a href="#什么是插槽" class="header-anchor">#</a> 什么是插槽?</h2> <p>插槽（Slot）是 Vue 提出来的一个概念，正如名字一样，插槽用于决定将所携带的内容，插入到指定的某个位置，从而使模板分块，具有模块化的特质和更大的重用性。
插槽显不显示、怎样显示是由父组件来控制的，而插槽在哪里显示就由子组件来进行控制。</p> <ol><li>单个插槽 slot 的基本使用</li></ol> <p>当子组件模板只有一个没有属性的插槽时， 父组件传入的整个内容片段将插入到插槽所在的 DOM 位置， 并替换掉插槽标签本身
子组件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> 默认显示，父组件没有内容时候显示 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// 子组件</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'childSlot1'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>父组件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-slot1</span> <span class="token attr-name">:url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>我是父组件传递进来的内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-slot1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> childSlot1 <span class="token keyword">from</span> <span class="token string">'./childSlot1'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// 父组件</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Index'</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'https://www.baidu.com'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      childSlot1<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>父组件中可以在子组件里面填入内容(也可以不填)，如上面 span 标签的内容！如果不填默认为子组件 slot 的内容</p> <ol start="2"><li>具名插槽</li></ol> <p>solt 元素可以用一个特殊的特性 name 来进一步配置如何分发内容。 多个插槽可以有不同的名字。 这样可以将父组件模板中 slot 位置， 和子组件 slot 元素产生关联，便于插槽内容对应传递</p> <p>子组件：定义 slot 标签，然后用 name 去定义不同的名字。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 头部导航 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 尾部导航 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// 子组件</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'childSlot1'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>父组件：在子组件里面填写 template，然后写上 v-slot,然后用名字区分来源于不同的插槽。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-slot1</span> <span class="token attr-name">:url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>header</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>父组件改变头部导航<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>footer</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>父组件改变尾部导航<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-slot1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> childSlot1 <span class="token keyword">from</span> <span class="token string">'./childSlot1'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// 父组件</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Index'</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://www.imooc.com'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      childSlot1<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="3"><li>作用域插槽</li></ol> <p>作用域插槽 使用场景： 由外部（父组件）指定子组件 template 中循环列表的结构，父组件可以获取子组件定义好的数据。
子组件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">:slotData</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>website<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{website.subTitle}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// 子组件</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'childSlot1'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">website</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'https://www.imooc.com'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'慕课网'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">subTitle</span><span class="token operator">:</span> <span class="token string">'程序员的最爱学习网站'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>父组件：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-slot1</span> <span class="token attr-name">:url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- slotProps的名字可以随便取 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>slotProps<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{slotProps.slotData.title}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-slot1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> childSlot1 <span class="token keyword">from</span> <span class="token string">'./childSlot1'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// 父组件</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Index'</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://www.baidu.com'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      childSlot1<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="谈谈你对-keep-alive-的了解"><a href="#谈谈你对-keep-alive-的了解" class="header-anchor">#</a> 谈谈你对 keep-alive 的了解？</h2> <p>keep-alive 可以实现组件的缓存，当组件切换时不会对当前组件进行卸载,常用的 2 个属性 include/exclude,2 个生命周期 activated,deactivated LRU 算法</p> <h2 id="vue-中常见性能优化"><a href="#vue-中常见性能优化" class="header-anchor">#</a> Vue 中常见性能优化</h2> <ol><li>不要将所有的数据都放在 data 中，data 中的数据都会增加 getter 和 setter，会收集对应的 watcher</li> <li>vue 在 v-for 时给每项元素绑定事件需要用事件代理</li> <li>SPA 页面采用 keep-alive 缓存组件</li> <li>拆分组件提高复用性、增加代码的可维护性,减少不必要的渲染</li> <li>v-if 当值为 false 时内部指令不会执行,具有阻断功能，很多情况下使用 v-if 替代 v-show</li> <li>key 保证唯一性(默认 vue 会采用就地复用策略)</li> <li>object.freeze 冻结数据</li> <li>合理使用路由懒加载、异步组件</li> <li>尽量采用 runtime 运行时版本</li> <li>数据持久化的问题( 防抖、节流 )</li></ol> <h2 id="hash-路由和-history-路由区别"><a href="#hash-路由和-history-路由区别" class="header-anchor">#</a> hash 路由和 history 路由区别</h2> <ol><li><p>hash 路由在地址栏 URL 上有#，用 window.location.hash 读取。而 history 路由没有会好看一点</p></li> <li><p>我们进行回车刷新操作，hash 路由会加载到地址栏对应的页面，而 history 路由一般就 404 报错了（刷新是网络请求，没有后端准备时会报错）。</p></li> <li><p>hash 路由支持低版本的浏览器，而 history 路由是 HTML5 新增的 API。</p></li> <li><p>hash 的特点在于它虽然出现在了 URL 中，但是不包括在 http 请求中，所以对于后端是没有一点影响的，所以改变 hash 不会重新加载页面，所以这也是单页面应用的必备。</p></li> <li><p>history 运用了浏览器的历史记录栈，之前有 back,forward,go 方法，之后在 HTML5 中新增了 pushState（）和 replaceState（）方法，它们提供了对历史记录进行修改的功能，不过在进行修改时，虽然改变了当前的 URL，但是浏览器不会马上向后端发送请求。</p></li> <li><p>history 的这种模式需要后台配置支持。比如：当我们进行项目的主页的时候，一切正常，可以访问，但是当我们刷新页面或者直接访问路径的时候就会返回 404，那是因为在 history 模式下，只是动态的通过 js 操作 window.history 来改变浏览器地址栏里的路径，并没有发起 http 请求，但是当我直接在浏览器里输入这个地址的时候，就一定要对服务器发起 http 请求，但是这个目标在服务器上又不存在，所以会返回 404</p></li></ol> <h2 id="vue-router-中导航守卫有哪些"><a href="#vue-router-中导航守卫有哪些" class="header-anchor">#</a> Vue-Router 中导航守卫有哪些 ?</h2> <ol><li>全局守卫</li></ol> <ul><li><p>全局前置守卫：router.beforeEach（回调函数）：一般用来做鉴权（尽早完成登陆验证）</p></li> <li><p>全局后置守卫：router.afterEach (回调函数)导航已经完成，设置网页标题等小任务</p></li> <li><p>全局解析守卫：router.beforeResolve（回调函数） 在所有的组件内守卫和异步路由组件被解析之后</p></li></ul> <ol start="2"><li>路由的守卫</li></ol> <p>beforeEnter，这个守卫是配置在路由里边的</p> <ol start="3"><li>组件内的守卫</li></ol> <ul><li><p>beforeRouteEnter</p></li> <li><p>beforeRouteUpdate 复用的组件执行的守卫，可以获取最新的数据</p></li> <li><p>beforeRouteLeave 拦截导航，防止误操作</p></li></ul> <ol start="4"><li>守卫的执行顺序</li></ol> <p>&lt;1&gt;导航被触发。</p> <p>&lt;2&gt;在失活的组件里调用 beforeRouteLeave 守卫。</p> <p>&lt;3&gt;调用全局的 beforeEach 守卫。</p> <p>&lt;4&gt;在重用的组件里调用 beforeRouteUpdate 守卫 。</p> <p>&lt;5&gt;在路由配置里调用 beforeEnter。</p> <p>&lt;6&gt;解析异步路由组件。</p> <p>&lt;7&gt;在被激活的组件里调用 beforeRouteEnter。</p> <p>&lt;8&gt;调用全局的 beforeResolve 守卫 (2.5+)。</p> <p>&lt;9&gt;导航被确认。</p> <p>&lt;10&gt;调用全局的 afterEach 钩子。</p> <p>&lt;11&gt;触发 DOM 更新。</p> <p>&lt;12&gt;调用 beforeRouteEnter 守卫中传给 next 的回调函数，创建好的组件实例会作为回调函数的参数传入。</p> <h2 id="说一下-vite-的原理"><a href="#说一下-vite-的原理" class="header-anchor">#</a> 说一下 vite 的原理</h2> <p>Vite 是新一代的前端构建工具，在尤雨溪开发 Vue3.0 的时候诞生。类似于 Webpack+ Webpack-dev-server。其主要利用浏览器 ESM 特性导入组织代码，在服务器端按需编译返回，完全跳过了打包这个概念，服务器随起随用。生产中利用 Rollup 作为打包工具，号称下一代的前端构建工具。</p> <p>Vite 有如下特点：</p> <ul><li>快速的冷启动: No Bundle + esbuild 预构建</li> <li>即时的模块热更新: 基于 ESM 的 HMR，同时利用浏览器缓存策略提升速度</li> <li>真正的按需加载: 利用浏览器 ESM 支持，实现真正的按需加载</li></ul> <p>Webpack 是近年来使用量最大，同时社区最完善的前端打包构建工具，新出的 5.x 版本对构建细节进行了优化，在部分场景下打包速度提升明显。Webpack 在启动时，会先构建项目模块的依赖图，如果在项目中的某个地方改动了代码，Webpack 则会对相关的依赖重新打包，随着项目的增大，其打包速度也会下降。</p> <p>Vite 相比于 Webpack 而言，没有打包的过程，而是直接启动了一个开发服务器 devServer。Vite 劫持浏览器的 HTTP 请求，在后端进行相应的处理将项目中使用的文件通过简单的分解与整合，然后再返回给浏览器(整个过程没有对文件进行打包编译)。所以编译速度很快。</p> <h3 id="esbuild"><a href="#esbuild" class="header-anchor">#</a> Esbuild</h3> <p>Vite 底层使用 Esbuild 实现对.<code>ts、jsx、.</code>js 代码文件的转化，所以先看下什么是 es-build。</p> <p>Esbuild 是一个 JavaScript`` Bundler 打包和压缩工具，它提供了与 Webpack、Rollup 等工具相似的资源打包能力。可以将 JavaScript 和 TypeScript 代码打包分发在网页上运行。但其打包速度却是其他工具的 10 ～ 100 倍。</p> <p>目前他支持以下的功能：</p> <ul><li>加载器</li> <li>压缩</li> <li>打包</li> <li>Tree shaking</li> <li>Source map 生成</li></ul> <h3 id="rollup"><a href="#rollup" class="header-anchor">#</a> Rollup</h3> <p>在生产环境下，Vite 使用 Rollup 来进行打包</p> <p>Rollup 是基于 ESM 的 JavaScript 打包工具。相比于其他打包工具如 Webpack，他总是能打出更小、更快的包。因为 Rollup 基于 ESM 模块，比 Webpack 和 Browserify 使用的 CommonJS 模块机制更高效。Rollup 的亮点在于同一个地方，一次性加载。能针对源码进行 Tree Shaking(去除那些已被定义但没被使用的代码)，以及 Scope Hoisting 以减小输出文件大小提升运行性能。</p> <p>Rollup 分为 build（构建）阶段和 output generate（输出生成）阶段。主要过程如下：</p> <p>获取入口文件的内容，包装成 module，生成抽象语法树
对入口文件抽象语法树进行依赖解析
生成最终代码
写入目标文件
如果你的项目（特别是类库）只有 JavaScript，而没有其他的静态资源文件，使用 Webpack 就有点大才小用了。因为 Webpack 打包的文件的体积略大，运行略慢，可读性略低。这时候 Rollup 也不失为一个好选择。</p> <h3 id="核心原理"><a href="#核心原理" class="header-anchor">#</a> 核心原理</h3> <ol><li>当声明一个 script 标签类型为 module 时,如</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;/src/main.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><ol start="2"><li>当浏览器解析资源时，会往当前域名发起一个 GET 请求 main.js 文件</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>请求到了 main.js 文件，会检测到内部含有 import 引入的包，又会 import 引用发起 HTTP 请求获取模块的内容文件，如 App.vue、vue 文件</li></ol> <blockquote><p>Vite 其核心原理是利用浏览器现在已经支持 ES6 的 import,碰见 import 就会发送一个 HTTP 请求去加载文件，Vite 启动一个 koa 服务器拦截这些请求，并在后端进行相应的处理将项目中使用的文件通过简单的分解与整合，然后再以 ESM 格式返回返回给浏览器。Vite 整个过程中没有对文件进行打包编译，做到了真正的按需加载，所以其运行速度比原始的 webpack 开发编译速度快出许多！</p></blockquote> <h3 id="基于-esm-的-dev-server"><a href="#基于-esm-的-dev-server" class="header-anchor">#</a> 基于 ESM 的 Dev server</h3> <p>在 Vite 出来之前，传统的打包工具如 Webpack 是先解析依赖、打包构建再启动开发服务器，Dev Server 必须等待所有模块构建完成，当我们修改了 bundle 模块中的一个子模块， 整个 bundle 文件都会重新打包然后输出。项目应用越大，启动时间越长。</p> <p><img src="/assets/img/v2-7c1e11500968d9af15dcd3ba85ca73ed_1440w.534e06fa.png" alt=""></p> <p>而 Vite 利用浏览器对 ESM 的支持，当 import 模块时，浏览器就会下载被导入的模块。先启动开发服务器，当代码执行到模块加载时再请求对应模块的文件,本质上实现了动态加载。灰色部分是暂时没有用到的路由，所有这部分不会参与构建过程。随着项目里的应用越来越多，增加 route，也不会影响其构建速度。</p> <p><img src="/assets/img/v2-7ddc4a82ccb5bce039888e551f00d714_1440w.182ba195.png" alt=""></p> <h3 id="基于-esm-的-hmr-热更新"><a href="#基于-esm-的-hmr-热更新" class="header-anchor">#</a> 基于 ESM 的 HMR 热更新</h3> <p>目前所有的打包工具实现热更新的思路都大同小异：主要是通过 WebSocket 创建浏览器和服务器的通信监听文件的改变，当文件被修改时，服务端发送消息通知客户端修改相应的代码，客户端对应不同的文件进行不同的操作的更新。</p> <h3 id="vs-webpack"><a href="#vs-webpack" class="header-anchor">#</a> VS Webpack</h3> <p>Webpack: 重新编译，请求变更后模块的代码，客户端重新加载</p> <p>Vite: 请求变更的模块，再重新加载</p> <p>Vite 通过 chokidar 来监听文件系统的变更，只用对发生变更的模块重新加载， 只需要精确的使相关模块与其临近的 HMR 边界连接失效即可，这样 HMR 更新速度就不会因为应用体积的增加而变慢而 Webpack 还要经历一次打包构建。所以 HMR 场景下，Vite 表现也要好于 Webpack。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/30/2023, 11:03:59 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/interview/article-5.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        网络面试题
      </a></span> <span class="next"><a href="/interview/article-7.html">
        nodejs 面试题
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.297cbe38.js" defer></script><script src="/assets/js/3.74b310ed.js" defer></script><script src="/assets/js/8.54bfb320.js" defer></script>
  </body>
</html>