(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{652:function(t,s,a){t.exports=a.p+"assets/img/vue2-code.6d65d259.png"},653:function(t,s,a){t.exports=a.p+"assets/img/vue3-code.7fb376e2.png"},654:function(t,s,a){t.exports=a.p+"assets/img/vue3.92a6587a.png"},697:function(t,s,a){"use strict";a.r(s);var e=a(73),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"vue3-环境搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue3-环境搭建"}},[t._v("#")]),t._v(" Vue3 环境搭建")]),t._v(" "),s("h2",{attrs:{id:"monorepo-管理项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#monorepo-管理项目"}},[t._v("#")]),t._v(" Monorepo 管理项目")]),t._v(" "),s("blockquote",[s("p",[t._v("Monorepo 是管理项目代码的一个方法，指在一个项目仓库（repo）中管理多个模块/包（package）")])]),t._v(" "),s("p",[t._v("Vue2 的代码放到了 src 目录中，根据功能进行了目录的拆分，Vue3 的源码则采用 monorepo 的方式进行管理，将模块拆分到 package 目录中，作为一个个包来管理，这样职责划分更加明确")]),t._v(" "),s("p",[s("img",{attrs:{src:a(652),alt:""}}),t._v(" "),s("img",{attrs:{src:a(653),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("一个仓库可以维护多个包、不用到处找仓库")]),t._v(" "),s("li",[t._v("方便版本管理和依赖管理，模块之间的引用调用更加方便")])]),t._v(" "),s("h2",{attrs:{id:"vue3-项目结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue3-项目结构"}},[t._v("#")]),t._v(" Vue3 项目结构")]),t._v(" "),s("p",[s("img",{attrs:{src:a(654),alt:""}})]),t._v(" "),s("h2",{attrs:{id:"vue3-采用-typescript"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue3-采用-typescript"}},[t._v("#")]),t._v(" Vue3 采用 typescript")]),t._v(" "),s("p",[t._v("复杂的框架项目开发，使用类型语言更有利于代码的维护，在编码期间就可以帮我们做类型检查，避免错误，所以 TS 已经是主流框架的标配")]),t._v(" "),s("blockquote",[s("p",[t._v("vue2 早起采用 Flow 来进行类型校验（Vue2 中对 TS 的支持并不友好），Vue3 源码采用 TS 来进行重写。同时 Vue2.7 也采用 TS 重构。TS 能对代码提供良好的类型校验，同时也支持复杂的类型推导")])]),t._v(" "),s("h2",{attrs:{id:"全局安装-pnpm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局安装-pnpm"}},[t._v("#")]),t._v(" 全局安装 pnpm")]),t._v(" "),s("blockquote",[s("p",[t._v("Vue3 中使用"),s("code",[t._v("pnpm")]),t._v(" "),s("code",[t._v("workspace")]),t._v("来实现 "),s("code",[t._v("monorepo")]),t._v("（pnpm 是快速、节省磁盘空间的包管理器。主要采用符号链接的方式管理模块）")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("npm install pnpm "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 全局安装pnpm")]),t._v("\n\npnpm init "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化配置文件")]),t._v("\n")])])]),s("h2",{attrs:{id:"创建-npmrc-文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建-npmrc-文件"}},[t._v("#")]),t._v(" 创建.npmrc 文件")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("shamefully"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("hoist "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("这里您可以尝试一下 Vue3，pnpm install vue@next 此时默认情况下 vue3 中依赖的模块不会被提升到 node_modules 下，添加羞耻的提升可以将 vue3 所依赖的模块提升到 node_modules 中")])]),t._v(" "),s("ul",[s("li",[t._v("比如，用"),s("code",[t._v("npm")]),t._v("安装"),s("code",[t._v("bootstrap")]),t._v("依赖会自动安装"),s("code",[t._v("JQ")]),t._v(" ,那么我们可以直接 用 "),s("code",[t._v("import")]),t._v("直接引入"),s("code",[t._v("JQ")])]),t._v(" "),s("li",[t._v("但是用 pnpm 安装"),s("code",[t._v("bootstrap")]),t._v("会把"),s("code",[t._v("bootstrap")]),t._v("其他依赖放到"),s("code",[t._v(".pnpm")]),t._v("文件下面，这样用"),s("code",[t._v("import")]),t._v("直接引入"),s("code",[t._v("JQ")]),t._v("是不行的，那么要解决这个问题就要用"),s("code",[t._v("shamefully-hoist = true")]),t._v("这个命令，一般在开发源码时才会使用（羞耻的提升）")]),t._v(" "),s("li",[t._v("没有安装就不应该可以引入，所有 npm 这种方式是不合理的")])]),t._v(" "),s("h2",{attrs:{id:"初始化-ts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化-ts"}},[t._v("#")]),t._v(" 初始化 TS")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("pnpm tsc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("init\n")])])]),s("p",[t._v("先添加一些 tsconfig 常用配置，后续需要其他的在添加")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"compilerOptions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"outDir"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dist"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 输出的目录")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"sourceMap"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 采用sourceMap")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"target"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"es2016"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 目标语法")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"module"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"esnext"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模块格式")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"moduleResolution"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模块解析方式")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"strict"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 严格方式")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"resolveJsonModule"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 解析json模块")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"esModuleInterop"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许通过es6语法引入commonjs模块")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"jsx"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"preserve"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// jsx不转义")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"lib"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"esnext"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 支持的类库")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"创建模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建模块"}},[t._v("#")]),t._v(" 创建模块")]),t._v(" "),s("blockquote",[s("p",[t._v("在 packages 目录下新建两个 package，用于手写响应式原理")])]),t._v(" "),s("ul",[s("li",[t._v("reactivity 响应式模块")]),t._v(" "),s("li",[t._v("shared 共享模块")])]),t._v(" "),s("p",[t._v("所有的包入口均为 "),s("code",[t._v("src/index.ts")]),t._v(" 这样可以实现统一打包，并在包信息中增添打包格式"),s("code",[t._v("formats")]),t._v("属性，用于最终打包的格式")])])}),[],!1,null,null,null);s.default=r.exports}}]);