<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>面向对象 | 前端食堂</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/assets/logo.png">
    <meta name="description" content="A lightweight creator for VuePress project.">
    <link rel="preload" href="/assets/css/0.styles.a0bdfdfc.css" as="style"><link rel="preload" href="/assets/js/app.18cfc572.js" as="script"><link rel="preload" href="/assets/js/3.a5cb75aa.js" as="script"><link rel="preload" href="/assets/js/18.10bb2453.js" as="script"><link rel="prefetch" href="/assets/js/10.48422cdc.js"><link rel="prefetch" href="/assets/js/11.a8e08e99.js"><link rel="prefetch" href="/assets/js/12.93534653.js"><link rel="prefetch" href="/assets/js/13.cdd6e4c7.js"><link rel="prefetch" href="/assets/js/14.bb7f88cf.js"><link rel="prefetch" href="/assets/js/15.dc0a8b14.js"><link rel="prefetch" href="/assets/js/16.54c24170.js"><link rel="prefetch" href="/assets/js/17.7fc350af.js"><link rel="prefetch" href="/assets/js/19.91ea26de.js"><link rel="prefetch" href="/assets/js/20.d758385d.js"><link rel="prefetch" href="/assets/js/21.69860b07.js"><link rel="prefetch" href="/assets/js/22.91c3ab45.js"><link rel="prefetch" href="/assets/js/23.8a4bdd9f.js"><link rel="prefetch" href="/assets/js/24.6d324242.js"><link rel="prefetch" href="/assets/js/25.6c487007.js"><link rel="prefetch" href="/assets/js/26.7d894af5.js"><link rel="prefetch" href="/assets/js/27.2438dc01.js"><link rel="prefetch" href="/assets/js/28.aa20fe99.js"><link rel="prefetch" href="/assets/js/29.9997d625.js"><link rel="prefetch" href="/assets/js/30.6d5c7421.js"><link rel="prefetch" href="/assets/js/31.9cbf3b45.js"><link rel="prefetch" href="/assets/js/32.3b279873.js"><link rel="prefetch" href="/assets/js/33.cf2b5de9.js"><link rel="prefetch" href="/assets/js/34.8503f271.js"><link rel="prefetch" href="/assets/js/35.3c8e7d29.js"><link rel="prefetch" href="/assets/js/36.437d0f2d.js"><link rel="prefetch" href="/assets/js/37.005c9168.js"><link rel="prefetch" href="/assets/js/38.4a406f5f.js"><link rel="prefetch" href="/assets/js/39.3825bb06.js"><link rel="prefetch" href="/assets/js/4.4d3ae024.js"><link rel="prefetch" href="/assets/js/40.f40399ca.js"><link rel="prefetch" href="/assets/js/41.5fc019a5.js"><link rel="prefetch" href="/assets/js/42.72af5fae.js"><link rel="prefetch" href="/assets/js/43.6c81947b.js"><link rel="prefetch" href="/assets/js/44.a15f0ec9.js"><link rel="prefetch" href="/assets/js/45.46cc1031.js"><link rel="prefetch" href="/assets/js/46.9c066483.js"><link rel="prefetch" href="/assets/js/47.0c62f90c.js"><link rel="prefetch" href="/assets/js/48.e262bdae.js"><link rel="prefetch" href="/assets/js/49.bec8f75b.js"><link rel="prefetch" href="/assets/js/5.afac0b68.js"><link rel="prefetch" href="/assets/js/50.3c1d03a3.js"><link rel="prefetch" href="/assets/js/51.4cb0e0da.js"><link rel="prefetch" href="/assets/js/52.e92eaca1.js"><link rel="prefetch" href="/assets/js/53.05babc86.js"><link rel="prefetch" href="/assets/js/54.8b49c8dd.js"><link rel="prefetch" href="/assets/js/55.983fed39.js"><link rel="prefetch" href="/assets/js/56.87e660f9.js"><link rel="prefetch" href="/assets/js/57.dadae08a.js"><link rel="prefetch" href="/assets/js/58.c6a8356d.js"><link rel="prefetch" href="/assets/js/59.4ad9e30c.js"><link rel="prefetch" href="/assets/js/6.bc437b1e.js"><link rel="prefetch" href="/assets/js/60.c86d364f.js"><link rel="prefetch" href="/assets/js/61.5a581a2d.js"><link rel="prefetch" href="/assets/js/62.56b0bca0.js"><link rel="prefetch" href="/assets/js/63.fe58d2ce.js"><link rel="prefetch" href="/assets/js/64.19c07325.js"><link rel="prefetch" href="/assets/js/65.2dd5f911.js"><link rel="prefetch" href="/assets/js/66.82a6e045.js"><link rel="prefetch" href="/assets/js/67.f5610f48.js"><link rel="prefetch" href="/assets/js/68.d9f1c646.js"><link rel="prefetch" href="/assets/js/69.22a44fd9.js"><link rel="prefetch" href="/assets/js/7.0927ac8c.js"><link rel="prefetch" href="/assets/js/70.bc88a09e.js"><link rel="prefetch" href="/assets/js/71.064eea43.js"><link rel="prefetch" href="/assets/js/72.280a3d03.js"><link rel="prefetch" href="/assets/js/73.01b30be4.js"><link rel="prefetch" href="/assets/js/74.08e19a9b.js"><link rel="prefetch" href="/assets/js/75.d61f7a90.js"><link rel="prefetch" href="/assets/js/76.4e8aa27a.js"><link rel="prefetch" href="/assets/js/77.e94e604e.js"><link rel="prefetch" href="/assets/js/8.daec2881.js"><link rel="prefetch" href="/assets/js/9.b912adcc.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.0d6d3bd4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a0bdfdfc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">前端食堂</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><a class="ant-dropdown-link ant-dropdown-trigger">
      Hover me <i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></a> <a href="https://github.com/wjhuan/frontend-learn-route" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/javascript/" aria-current="page" title="README.md" class="sidebar-link">README.md</a></li><li><a href="/javascript/article-1.html" title="数据类型" class="sidebar-link">数据类型</a></li><li><a href="/javascript/article-2.html" title="JS底层堆栈内存处理机制" class="sidebar-link">JS底层堆栈内存处理机制</a></li><li><a href="/javascript/article-3.html" title="闭包作用域和浏览器垃圾回收机制" class="sidebar-link">闭包作用域和浏览器垃圾回收机制</a></li><li><a href="/javascript/article-4.html" title="this的几种基本情况" class="sidebar-link">this的几种基本情况</a></li><li><a href="/javascript/article-5.html" aria-current="page" title="面向对象" class="active sidebar-link">面向对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/article-5.html#面向对象基础" title="面向对象基础" class="sidebar-link">面向对象基础</a></li><li class="sidebar-sub-header"><a href="/javascript/article-5.html#原型-和-原型链" title="原型 和 原型链" class="sidebar-link">原型 和 原型链</a></li><li class="sidebar-sub-header"><a href="/javascript/article-5.html#class-语法" title="Class 语法" class="sidebar-link">Class 语法</a></li><li class="sidebar-sub-header"><a href="/javascript/article-5.html#函数的三种角色" title="函数的三种角色" class="sidebar-link">函数的三种角色</a></li><li class="sidebar-sub-header"><a href="/javascript/article-5.html#重写内置-new" title="重写内置 new" class="sidebar-link">重写内置 new</a></li><li class="sidebar-sub-header"><a href="/javascript/article-5.html#深浅拷贝" title="深浅拷贝" class="sidebar-link">深浅拷贝</a></li><li class="sidebar-sub-header"><a href="/javascript/article-5.html#类的继承" title="类的继承" class="sidebar-link">类的继承</a></li></ul></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="面向对象"><a href="#面向对象" class="header-anchor">#</a> 面向对象</h1> <h2 id="面向对象基础"><a href="#面向对象基础" class="header-anchor">#</a> 面向对象基础</h2> <ul><li><code>OOP</code>思想：对象、类、实例</li> <li><code>JS</code>语言本身就是基于类和实例构建和组成的</li> <li><code>JS</code>中有很多的内置类
<ol><li>每一种数据类型值都有自己所属的内置类(专业叫法：构造函数)
<ul><li>大类：<code>Object</code></li> <li>小类：<code>Number</code>、<code>String</code>、<code>Boolean</code>、<code>Symbol</code>、<code>BigInt</code>、<code>Function</code>、<code>Array</code>、<code>RegExp</code>、<code>Date</code>、<code>Set</code>、<code>Map</code>....</li></ul></li> <li>每一 HTML 标签(或者每一个节点)，都有自己所属的内置类
<blockquote><p>body -&gt; HTMLBodyElement -&gt; HTMLElement -&gt; Element -&gt; Node -&gt; EventTarget -&gt; Object</p></blockquote></li></ol></li> <li>创建一个函数，执行的时候，把其<code>new</code>执行，则当前函数被称为<code>自定义构造函数(类)</code>；执行的返回结果一般是当前类的一个<code>实例</code>；
<code>new</code>多次会创造多个不同的实例对象<code>「实例对象的独立性」</code>；基于<code>this.xxx=xxx</code>是给实例对象设置<code>私有属性方法</code>；</li> <li>普通函数执行 VS 构造函数执行</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">=</span> x <span class="token operator">+</span> y
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">我计算的和是:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>total<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// 普通函数执行  Fn执行的返回值赋值给res</span>
<span class="token keyword">let</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">//构造函数执行  把Fn当做一个类，f1是创造出来的一个实例</span>
<span class="token keyword">let</span> f2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>sum<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>total<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>say <span class="token operator">===</span> f2<span class="token punctuation">.</span>say<span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/Xnip2021-12-03_21-28-03.3c8f194d.jpg" alt=""></p> <h2 id="原型-和-原型链"><a href="#原型-和-原型链" class="header-anchor">#</a> 原型 和 原型链</h2> <blockquote><p>大部分<code>函数数据类型</code>的值都具备<code>prototype（原型/显式原型）</code>属性，属性值本身是一个对象「浏览器会默认为其开辟一个堆内存，用来存储实例可调用的公共的属性和方法」，在浏览器默认开辟的这个堆内存中「原型对象」有一个默认的属性<code>constructor（构造函数/构造器）</code>，属性值是当前<code>函数/类本身</code>！！</p></blockquote> <ol><li>函数数据类型
<ul><li>普通函数（实名或者匿名函数）</li> <li>箭头函数</li> <li>构造函数/类「内置类/自定义类」</li> <li>生成器函数 Generator</li></ul></li> <li>不具备<code>prototype</code>的函数
<ul><li>箭头函数</li> <li>基于<code>ES6</code>给对象某个成员赋值函数值的快捷操作</li></ul></li></ol> <blockquote><p>每一个<code>对象数据类型</code>的值都具备一个属性<code>__proto__（原型链/隐式原型）</code>，属性值指向<code>自己所属类的原型prototype</code></p></blockquote> <ul><li><code>Object.create(null)</code>创建出的对象是没有原型的</li></ul> <p>对象数据类型值</p> <ol><li>普通对象</li> <li>特殊对象：数组、正则、日期、Math、Error…</li> <li>函数对象</li> <li>实例对象</li> <li>构造函数.prototype</li></ol> <p><img src="/assets/img/Xnip2021-12-05_10-44-45.fe984446.jpg" alt=""></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">200</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getX</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getX</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getY</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> f2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>getX <span class="token operator">===</span> f2<span class="token punctuation">.</span>getX<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>getY <span class="token operator">===</span> f2<span class="token punctuation">.</span>getY<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>getY <span class="token operator">===</span> <span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>getY<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>getX <span class="token operator">===</span> f2<span class="token punctuation">.</span>getX<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>getX <span class="token operator">===</span> <span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>getX<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor<span class="token punctuation">)</span>
f1<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
f1<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
f2<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/Xnip2021-12-03_22-25-44.4a1adcc9.jpg" alt=""></p> <h3 id="object-prototype-hasownproperty"><a href="#object-prototype-hasownproperty" class="header-anchor">#</a> Object.prototype.hasOwnProperty</h3> <blockquote><p>用来检测是否为私有属性</p></blockquote> <ul><li>语法：<code>[对象]</code>.hasOwnProperty(<code>[属性]</code>)</li> <li>检测<code>[属性]</code>是否为<code>[对象]</code>的私有属性，是返回<code>TRUE</code>，不是则返回<code>FALSE</code>；只看私有中有没有(和公有是否存在没关系)；</li></ul> <h3 id="in-操作符"><a href="#in-操作符" class="header-anchor">#</a> in 操作符</h3> <ul><li>语法：<code>[属性]</code> in <code>[对象]</code></li> <li>检测<code>[属性]</code>是否率属于这个<code>[对象]</code>，不论公有还是私有，只要能访问到这个属性，则结果就是<code>TRUE</code></li></ul> <p>实现<code>Object.prototype.hasPubProperty</code>，用户来检测当前属性是否为对象的公有属性（无关私有中是否存在）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hasPubProperty</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">hasPubProperty</span><span class="token punctuation">(</span><span class="token parameter">attr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this-&gt;obj要处理的对象  attr-&gt;'toString'要检测的属性</span>
  <span class="token comment">// 思路：跳过私有属性的查找，直接在公有属性中查找，看看是否存在</span>
  <span class="token comment">// Object.getPrototypeOf([实例对象])：获取当前实例对象的原型对象(或者获取“实例对象.__proto__”)</span>
  <span class="token keyword">let</span> proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>proto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
    proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token comment">// 思路：是对象的属性，而且还不是私有的属性，这样只能是公有属性了</span>
  <span class="token comment">// 问题：如果attr即是私有的属性，也是公有的属性，基于这种方案检测结果是false</span>
  <span class="token comment">// return attr in this &amp;&amp; !this.hasOwnProperty(attr)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="class-语法"><a href="#class-语法" class="header-anchor">#</a> Class 语法</h2> <ol><li>基于<code>Class</code>语法，设置的原型上的公共方法（或者静态私有方法）都是不可枚举的属性；但是基于 <code>xxx=xxx</code> 这种写法，设置的属性是可枚举的；</li> <li>基于<code>Class</code>语法创造的构造函数，是不能当做普通函数执行的 <code>Uncaught TypeError: Class constructor Modal cannot be invoked without</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
  <span class="token comment">// 构造函数体：两种写法都是给实例设置私有的属性方法</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
    <span class="token comment">// this.sum = function () { };</span>
  <span class="token punctuation">}</span>
  z <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 在原型对象上设置供实例调用的“公共方法”「基于Class语法，无法向原型上直接设置公有属性」</span>
  <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 把其作为普通对象，设置静态私有属性方法</span>
  <span class="token keyword">static</span> n <span class="token operator">=</span> <span class="token number">200</span>
  <span class="token keyword">static</span> <span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>n <span class="token operator">+=</span> n
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 向原型扩展公共属性</span>
<span class="token class-name">Modal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'zhufeng'</span>

<span class="token keyword">let</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Modal</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 构造函数体 this-&gt;实例</span>
  <span class="token comment">// 这里是给实例设置的私有属性方法</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
<span class="token punctuation">}</span>
<span class="token comment">//把Modal作为构造函数，在其原型对象上设置供实例调用的公共属性方法</span>
<span class="token class-name">Modal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">10</span>
<span class="token class-name">Modal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getX</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Modal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getY</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//把Modal作为普通对象，设置的静态私有属性方法</span>
Modal<span class="token punctuation">.</span>n <span class="token operator">=</span> <span class="token number">200</span>
Modal<span class="token punctuation">.</span><span class="token function-variable function">setNumber</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>n <span class="token operator">=</span> n
<span class="token punctuation">}</span>
<span class="token keyword">let</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Model</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="函数的三种角色"><a href="#函数的三种角色" class="header-anchor">#</a> 函数的三种角色</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">functionFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Foo<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Foo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Foo<span class="token punctuation">.</span>getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">new</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/Xnip2021-12-05_14-54-06.a7326009.jpg" alt=""></p> <h2 id="重写内置-new"><a href="#重写内置-new" class="header-anchor">#</a> 重写内置 new</h2> <blockquote><p>面试题：假如没有<code>new</code>关键词，需要我们自己编写<code>_new</code>方法，实现出和<code>new</code>相同的效果</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bark</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'wangwang'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'my name is '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> sanmao <span class="token operator">=</span> <span class="token function">_new</span><span class="token punctuation">(</span>Dog<span class="token punctuation">,</span> <span class="token string">'三毛'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span>
sanmao<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//=&gt;&quot;wangwang&quot;</span>
sanmao<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//=&gt;&quot;my name is 三毛&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sanmao <span class="token keyword">instanceof</span> <span class="token class-name">Dog</span><span class="token punctuation">)</span> <span class="token comment">//=&gt;true  instanceof是用来检测某个对象是否是当前构造函数的实例对象</span>
</code></pre></div><p><code>_new</code> 函数实现</p> <ol><li>创造当前类 Ctor 的一个实例对象「<code>空对象</code>、<code>__proto__</code>===<code>Ctor.prototype</code>」</li> <li>把构造函数当做普通函数执行，只不过让函数中的<code>this</code>指向创建的实例对象</li> <li>判断函数执行的返回值，如果返回的是对象，则以自己返回的为主；否则把创建的实例对象返回！</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">Ctor<span class="token punctuation">,</span> <span class="token operator">...</span>params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// @1 创造当前类Ctor的一个实例对象「空对象、__proto__===Ctor.prototype」</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Ctor</span><span class="token punctuation">.</span>prototype
  <span class="token comment">// @2 把构造函数当做普通函数执行，只不过让函数中的this指向创建的实例对象</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">Ctor</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token operator">...</span>params<span class="token punctuation">)</span>
  <span class="token comment">// @3 判断函数执行的返回值，如果返回的是对象，则以自己返回的为主；否则把创建的实例对象返回！</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(object|function)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">Ctor<span class="token punctuation">,</span> <span class="token operator">...</span>params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    result
  Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token class-name">Ctor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">//给某个对象设置原型指向(也就是让obj.__proto__===Ctor.prototype)，只兼容IE11及以上 *!/</span>
  <span class="token comment">// Object.create(proto)：创建一个空对象，并且把proto作为空对象的原型指向（空对象.__proto__===proto）；proto必须是对象或者null；如果是null则是创造一个没有原型指向的对象； 不兼容IE6~8</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Ctor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">,</span>
    result
  result <span class="token operator">=</span> <span class="token function">Ctor</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token operator">...</span>params<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(object|function)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">Ctor<span class="token punctuation">,</span> <span class="token operator">...</span>params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> obj<span class="token punctuation">,</span>
    result<span class="token punctuation">,</span>
    proto <span class="token operator">=</span> <span class="token class-name">Ctor</span><span class="token punctuation">.</span>prototype
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>proto <span class="token operator">||</span> Ctor <span class="token operator">===</span> Symbol <span class="token operator">||</span> Ctor <span class="token operator">===</span> BigInt<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Ctor is not a constructor'</span><span class="token punctuation">)</span>
  obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span>
  result <span class="token operator">=</span> <span class="token function">Ctor</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token operator">...</span>params<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(object|function)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre></div><p>最终优化版本</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">Ctor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Ctor <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Ctor is not a constructor'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Ctor</span><span class="token punctuation">.</span>prototype <span class="token operator">||</span> Ctor <span class="token operator">===</span> Symbol <span class="token operator">||</span> Ctor <span class="token operator">===</span> BigInt<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Ctor is not a constructor'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> obj<span class="token punctuation">,</span> result<span class="token punctuation">,</span> params
  params <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Ctor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
  result <span class="token operator">=</span> <span class="token function">Ctor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(object|function)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre></div><h2 id="深浅拷贝"><a href="#深浅拷贝" class="header-anchor">#</a> 深浅拷贝</h2> <ol><li>浅拷贝
<blockquote><p>自己创建一个新的对象，来接受你要重新复制或引用的对象值。如果对象属性是基本的数据类型，复制的就是基本类型的值给新对象；但如果属性是引用数据类型，复制的就是内存中的地址，如果其中一个对象改变了这个内存中的地址，肯定会影响到另一个对象。</p></blockquote> <ul><li>object.assign</li> <li>拓展运算符</li> <li>concat 拷贝数组</li> <li>slice 拷贝数组</li></ul></li> <li>深拷贝
<blockquote><p>浅拷贝只是创建了一个新的对象，复制了原有对象的基本类型的值，而引用数据类型只拷贝了一层属性，再深层的还是无法进行拷贝。深拷贝则不同，对于复杂引用数据类型，其在堆内存中完全开辟了一块内存地址，并将原有的对象完全复制过来存放。深拷贝后的对象与原始对象是相互独立、不受影响的，彻底实现了内存上的分离。</p></blockquote> <ul><li>​JSON.stringify
<ul><li>无法处理<code>BigInt</code>类型的属性值 <code>Uncaught TypeError: Do not know how to serialize a BigInt</code></li> <li>属性值是 <code>undefined/symbol/function</code> 类型的,属性名是 <code>symbol</code> 类型的键值对会消失</li> <li>属性值如果是 <code>正则对象/错误对象</code> 会转换为<code>{}</code>，值和之前是不一样的</li> <li>日期对象变为字符串之后就无法在转换回日期对象了</li> <li>一但内部出现“套娃操作”<code>（obj.obj=obj）</code>，直接处理不了 <code>Uncaught TypeError: Converting circular structure to JSON</code></li></ul></li></ul></li></ol> <h3 id="深拷贝实现原理"><a href="#深拷贝实现原理" class="header-anchor">#</a> 深拷贝实现原理</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 检测是否为标准普通对象(纯粹对象)</span>
<span class="token keyword">const</span> <span class="token function-variable function">isPlainObject</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">isPlainObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> proto<span class="token punctuation">,</span> Ctor
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj <span class="token operator">||</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'[object Object]'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  proto <span class="token operator">=</span> <span class="token function">getProto</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>proto<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
  Ctor <span class="token operator">=</span>
    <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>proto<span class="token punctuation">,</span> <span class="token string">'constructor'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
    proto<span class="token punctuation">.</span>constructor
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> Ctor <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> Ctor <span class="token operator">===</span> Object
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">isComplexDataType</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> obj <span class="token operator">!==</span> <span class="token keyword">null</span>

<span class="token comment">/* 数组/对象的深浅拷贝&amp;深浅合并 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">deepClone</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">,</span> hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Date<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// 日期对象直接返回一个新的日期对象</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> RegExp<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">//正则对象直接返回一个新的正则对象</span>

  <span class="token comment">//如果循环引用了就用 weakMap 来解决</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>hash<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> hash<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

  <span class="token keyword">let</span> allDesc <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

  <span class="token comment">//遍历传入参数所有键的特性</span>

  <span class="token keyword">let</span> cloneObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">,</span> allDesc<span class="token punctuation">)</span>

  <span class="token comment">//继承原型链</span>

  hash<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> cloneObj<span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cloneObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span>
      <span class="token function">isComplexDataType</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">'function'</span>
        <span class="token operator">?</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> hash<span class="token punctuation">)</span>
        <span class="token operator">:</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> cloneObj
<span class="token punctuation">}</span>
</code></pre></div><h2 id="类的继承"><a href="#类的继承" class="header-anchor">#</a> 类的继承</h2> <ol><li>原型继承
<blockquote><p>原型继承的关键： 设置 Child 原型指向 ParentChild.prototype = new Parent()。创建子类实例时，无法向父类构造函数传参</p></blockquote></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>hobby <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 缺点：Parent的引用属性会被所有Child实例共享，互相干扰</span>
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Parent say'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 原型继承的关键</span>
</code></pre></div><ol start="2"><li>构造函数继承
<blockquote><p>构造函数继承的关键： 在 Child 构造函数中执行 Parent.call(this)。我发继承父类原型上的方法</p></blockquote></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>hobby <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">speak</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Parent speak'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token comment">// 缺点1：new多个Child时，Parent构造函数中的方法会在每个Child中拷贝一份，浪费内存</span>
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Parent say'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token comment">// 缺点2：Parent原型对象上的方法不会被Child继承</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token comment">// 构造函数继承的关键</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>组合继承</li></ol> <ul><li>属性使用构造函数继承 —— 避免了原型继承中 Parent 引用属性被所有 Child 实例共享的缺陷</li> <li>方法使用原型继承 —— 避免了构造函数继承中方法重复拷贝、浪费内存的缺陷。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>hobby <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 属性放在构造函数中</span>
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 方法放在原型中</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Parent say'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token comment">// Child继承Parent属性（构造函数继承）</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type <span class="token comment">// Child扩展属性</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// Child继承Parent方法（原型继承）</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">speak</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Child扩展方法</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Child speak'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child <span class="token comment">// 修复Child的constructor指向，否则Child的constructor会指向Parent</span>
</code></pre></div><ol start="4"><li>es6 继承：class+extends+super</li></ol> <ul><li>继承父实例属性：写在父的 constructor 中，子使用 super 访问</li> <li>继承父实例方法：写在父类体中，子实例对象.方法名</li> <li>继承静态方法、静态属性：使用 static 声明，子构造函数.静态方法名/静态属性名</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> weight</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'父类构造器'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> weight
  <span class="token punctuation">}</span>
  <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> animalAttr <span class="token operator">=</span> <span class="token string">'父类静态属性'</span>
  <span class="token keyword">static</span> <span class="token function">animalMethod</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> d <span class="token keyword">instanceof</span> <span class="token class-name">Animal</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 继承 1、extends关键字继承 显示调用super()</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> weight<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2、super类似于 Animal.call(this)  继承父的实例属性</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> weight<span class="token punctuation">)</span> <span class="token comment">//</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子类构造器'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type
  <span class="token punctuation">}</span>
  <span class="token comment">// 6、当子类存在与父类相同时，优先执行子类</span>
  <span class="token comment">// sayName() {</span>
  <span class="token comment">//   console.log('子类的sayName');</span>
  <span class="token comment">// }</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> d1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'可乐'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">'10kg'</span><span class="token punctuation">,</span> <span class="token string">'金毛'</span><span class="token punctuation">)</span>
<span class="token comment">// console.log(d1); //Dog { name: '可乐', age: 12, weight: '10kg', type: '金毛' }</span>
<span class="token comment">// 3、继承类体方法</span>
d1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//可乐</span>
<span class="token comment">// 4、继承静态属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Dog<span class="token punctuation">.</span>animalAttr<span class="token punctuation">)</span> <span class="token comment">//父类静态属性</span>
<span class="token comment">// 5、继承静态方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Dog<span class="token punctuation">.</span><span class="token function">animalMethod</span><span class="token punctuation">(</span>d1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/9/2023, 10:39:21 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/javascript/article-4.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        this的几种基本情况
      </a></span> <!----></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.18cfc572.js" defer></script><script src="/assets/js/3.a5cb75aa.js" defer></script><script src="/assets/js/18.10bb2453.js" defer></script>
  </body>
</html>